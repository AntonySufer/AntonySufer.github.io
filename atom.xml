<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>一点</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://note.yidianwz.com/"/>
  <updated>2019-05-09T08:22:44.987Z</updated>
  <id>http://note.yidianwz.com/</id>
  
  <author>
    <name>chatYu</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Sequelize  Model sql的操作</title>
    <link href="http://note.yidianwz.com/2019/05/09/Sequelize-Model-sql%E7%9A%84%E6%93%8D%E4%BD%9C/"/>
    <id>http://note.yidianwz.com/2019/05/09/Sequelize-Model-sql的操作/</id>
    <published>2019-05-09T03:28:21.000Z</published>
    <updated>2019-05-09T08:22:44.987Z</updated>
    
    <content type="html"><![CDATA[<h3 id="参考资源"><a href="#参考资源" class="headerlink" title="参考资源"></a>参考资源</h3><ul><li><a href="https://itbilu.com/nodejs/npm/VJIR1CjMb.html" target="_blank" rel="noopener">https://itbilu.com/nodejs/npm/VJIR1CjMb.html</a></li><li><a href="https://itbilu.com/nodejs/npm/V1PExztfb.html#api-findAll" target="_blank" rel="noopener">https://itbilu.com/nodejs/npm/V1PExztfb.html#api-findAll</a></li><li><a href="https://www.cnblogs.com/wanghui-garcia/p/10063226.html" target="_blank" rel="noopener">https://www.cnblogs.com/wanghui-garcia/p/10063226.html</a></li><li><a href="https://stackoverflow.com/questions/34364518/sequelize-where-on-parent-and-child-tables" target="_blank" rel="noopener">https://stackoverflow.com/questions/34364518/sequelize-where-on-parent-and-child-tables</a> </li><li><a href="http://www.cnblogs.com/hss-blog/articles/10220267.html" target="_blank" rel="noopener">http://www.cnblogs.com/hss-blog/articles/10220267.html</a>   （组合查询几种方式）</li><li><a href="http://www.cppcns.com/wangluo/javascript/173346.html（group" target="_blank" rel="noopener">http://www.cppcns.com/wangluo/javascript/173346.html（group</a> by 操作）</li><li><a href="https://itbilu.com/nodejs/npm/41qaV3czb.html#associations-one-to-one（连表关系理解）" target="_blank" rel="noopener">https://itbilu.com/nodejs/npm/41qaV3czb.html#associations-one-to-one（连表关系理解）</a></li></ul><h4 id="基本-操作"><a href="#基本-操作" class="headerlink" title="基本 操作"></a>基本 操作</h4> <br><br><br>#### 示例 datebase<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">// 用户表 ---&gt; 信息表</span><br><span class="line">// 用户表 --&gt; 班级表</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">CREATE TABLE IF NOT EXISTS `yd_user` (</span><br><span class="line">  `id` int(11) auto_increment  NOT NULL  COMMENT &apos;主键&apos;,</span><br><span class="line">  `account` varchar(25) NOT NULL COMMENT &apos;编号&apos;,</span><br><span class="line">  `class_id` varchar(25) NOT NULL COMMENT &apos;班级&apos;, -- 外键 class</span><br><span class="line">  `info_id` int NOT NULL COMMENT &apos;信息表id&apos;, -- 外键 info id</span><br><span class="line">  `create_time` datetime NOT NULL COMMENT &apos;创建时间&apos;,</span><br><span class="line">  `create_person` varchar(15) NOT NULL DEFAULT &apos;&apos; COMMENT &apos;创建人&apos;,</span><br><span class="line">  PRIMARY KEY (`id`),</span><br><span class="line">  UNIQUE KEY `U_INDEX_YD_ACCOUNT` (`account`) -- 唯一索引</span><br><span class="line">) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT=&apos;用户表&apos;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CREATE TABLE IF NOT EXISTS `yd_info` (</span><br><span class="line">  `id` int(11) auto_increment  NOT NULL  COMMENT &apos;主键&apos;,</span><br><span class="line">  `account` varchar(25) NOT NULL COMMENT &apos;账号&apos;,</span><br><span class="line">  `user_name` varchar(15) NOT NULL COMMENT &apos;名称&apos;,</span><br><span class="line">  `sex` varchar(10) NOT NULL COMMENT &apos;性别&apos;,</span><br><span class="line">  `age` varchar(10) NOT NULL COMMENT &apos;年龄&apos;,</span><br><span class="line">  `create_time` datetime NOT NULL COMMENT &apos;创建时间&apos;,</span><br><span class="line">  `create_person` varchar(15) NOT NULL DEFAULT &apos;&apos; COMMENT &apos;创建人&apos;,</span><br><span class="line">  PRIMARY KEY (`id`),</span><br><span class="line">  KEY `Index_YD_INFO_SEX` (`sex`),  -- 索引</span><br><span class="line">  KEY `Index_YD_INFO_AGE` (`age`)  -- 索引</span><br><span class="line">) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT=&apos;信息表&apos;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CREATE TABLE IF NOT EXISTS `yd_class` (</span><br><span class="line">  `id` int(11) auto_increment  NOT NULL  COMMENT &apos;主键&apos;,</span><br><span class="line">  `class_id` varchar(25) NOT NULL COMMENT &apos;班级&apos;,</span><br><span class="line">  `class_name` varchar(30) NOT NULL COMMENT &apos;性别&apos;,</span><br><span class="line">  `create_time` datetime NOT NULL COMMENT &apos;创建时间&apos;,</span><br><span class="line">  `create_person` varchar(15) NOT NULL DEFAULT &apos;&apos; COMMENT &apos;创建人&apos;,</span><br><span class="line">  PRIMARY KEY (`id`),</span><br><span class="line">  KEY `Index_YD_CLASS_NAME` (`class_name`),  -- 索引</span><br><span class="line">  UNIQUE  KEY `Index_YD_CLASS_ID` (`class_id`)  -- 索引</span><br><span class="line">) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT=&apos;班级表&apos;;</span><br></pre></td></tr></table></figure><h4 id="Sequelize-操作单表"><a href="#Sequelize-操作单表" class="headerlink" title="Sequelize 操作单表"></a>Sequelize 操作单表</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">//举个例子</span><br><span class="line">let rows = await models.yd_user.findAndCountAll(&#123;</span><br><span class="line">           logging:true, //日志</span><br><span class="line">           attributes:[</span><br><span class="line">               &apos;id&apos;,&apos;account&apos;,&apos;class_id&apos;,&apos;info_id&apos;,&apos;create_time&apos;</span><br><span class="line">              // [db[&apos;sequelize_yidian&apos;].fn(&apos;MAX&apos;, db[&apos;sequelize_yidian&apos;].col(&apos;id&apos;)),&apos;total&apos;],</span><br><span class="line">               ],  // 连接池 Sequelize</span><br><span class="line">           rows:true,</span><br><span class="line">           order: [[&apos;id&apos;,&apos;DESC&apos;],[&apos;create_time&apos;,&apos;desc&apos;]],</span><br><span class="line">           where:&#123;</span><br><span class="line">                   create_time: &#123; $gte: &apos;1997-01-01&apos;, $lte: formatDate(new Date()) &#125;,</span><br><span class="line">                   account:&#123;$like:&apos;user%&apos;&#125;</span><br><span class="line">                 </span><br><span class="line">               &#125;</span><br><span class="line">       &#125;);</span><br></pre></td></tr></table></figure><h4 id="关联表查询-方式一-（查询时候建立连接）"><a href="#关联表查询-方式一-（查询时候建立连接）" class="headerlink" title="关联表查询 方式一 （查询时候建立连接）"></a>关联表查询 方式一 （查询时候建立连接）</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">   let rows = await models.yd_user.findAndCountAll(&#123;</span><br><span class="line">            logging:true,</span><br><span class="line">            attributes:[</span><br><span class="line">               &apos;id&apos;,&apos;class_id&apos;,&apos;info_id&apos;,&apos;create_time&apos;,</span><br><span class="line">                [db[&apos;sequelize_yidian&apos;].col(&apos;info.user_name&apos;),&apos;user_name&apos;],  //重命名字段</span><br><span class="line">                db[&apos;sequelize_yidian&apos;].col(&apos;class.class_name&apos;,&apos;class_name&apos;),   </span><br><span class="line">            ],</span><br><span class="line">            raw: true,  //raw 的作用 合并数据</span><br><span class="line">            order: [[&apos;id&apos;,&apos;DESC&apos;]],</span><br><span class="line">            where:&#123;&apos;$info.id$&apos;: 1,class_id:&apos;一&apos;&#125;, //关联表条件</span><br><span class="line">            include:[</span><br><span class="line">              &#123;</span><br><span class="line">                attributes:[],</span><br><span class="line">                required:true,</span><br><span class="line">                association:models.yd_user.belongsTo(models.yd_info,&#123;foreignKey:&apos;info_id&apos;,as:&apos;info&apos;&#125;),</span><br><span class="line">              &#125;,</span><br><span class="line">              &#123;</span><br><span class="line">                  attributes:[],</span><br><span class="line">                  required:true,</span><br><span class="line">                association:models.yd_user.belongsTo(models.yd_class,&#123;targetKey: &apos;class_id&apos;,foreignKey:&apos;class_id&apos;,as:&apos;class&apos;&#125;),</span><br><span class="line">              &#125;</span><br><span class="line">            ],</span><br><span class="line"></span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">return&#123;</span><br><span class="line">        &quot;count&quot;: 1,</span><br><span class="line">        &quot;rows&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;id&quot;: 1,</span><br><span class="line">                &quot;class_id&quot;: &quot;一&quot;,</span><br><span class="line">                &quot;info_id&quot;: 1,</span><br><span class="line">                &quot;create_time&quot;: &quot;2019-05-07T17:10:05.000Z&quot;,</span><br><span class="line">                &quot;user_name&quot;: &quot;te&quot;,</span><br><span class="line">                &quot;class_name&quot;: &quot;1班&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><h4 id="原始查询-query"><a href="#原始查询-query" class="headerlink" title="原始查询 query"></a>原始查询 query</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">let rows = await db[&apos;sequelize_yidian&apos;].query( //  db[&apos;sequelize_yidian&apos;] =  自己Sequelize  连接池</span><br><span class="line">         `select A.ID,A.account,b.user_name,b.age from  yd_user as A left join yd_info as b on a.info_id = b.id where a.id =? and b.id=?  `, &#123;</span><br><span class="line">             replacements: [&apos;1&apos;,&apos;1&apos;],</span><br><span class="line">             type : &apos;SELECT&apos;  //type 的作用</span><br><span class="line">         &#125;);</span><br><span class="line">//结果         </span><br><span class="line">return  [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;ID&quot;: 1,</span><br><span class="line">            &quot;account&quot;: &quot;user_01&quot;,</span><br><span class="line">            &quot;user_name&quot;: &quot;te&quot;,</span><br><span class="line">            &quot;age&quot;: &quot;10&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br></pre></td></tr></table></figure><h4 id="group-by-操作"><a href="#group-by-操作" class="headerlink" title="group by  操作"></a>group by  操作</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">     let rows = await models.yd_class.findAll(&#123;</span><br><span class="line">            logging:true,</span><br><span class="line">            attributes:[</span><br><span class="line">               &apos;class_id&apos;,&apos;class_name&apos;,</span><br><span class="line">                [db[&apos;sequelize_yidian&apos;].fn(&apos;count&apos;, db[&apos;sequelize_yidian&apos;].col(&apos;user.id&apos;)),&apos;count&apos;]</span><br><span class="line">            ],</span><br><span class="line">            raw: true,</span><br><span class="line">            order: [[&apos;id&apos;,&apos;DESC&apos;]],</span><br><span class="line">            where:&#123;</span><br><span class="line">                 class_id: &#123; $lte: 3 &#125;,</span><br><span class="line">                &apos;$user.id$&apos;:&#123; $lte: 3 &#125; //关联表条件</span><br><span class="line">                &#125;,</span><br><span class="line">            group:&apos;class_id&apos;,</span><br><span class="line">           // having:&#123;&quot;$count$&quot;:&#125;,  //having 报错，原因未解决</span><br><span class="line">            include:[</span><br><span class="line">              &#123;</span><br><span class="line">                  attributes:[],</span><br><span class="line">                  required:true,</span><br><span class="line">                association:models.yd_class.belongsTo(models.yd_user,&#123;targetKey: &apos;class_id&apos;,foreignKey:&apos;class_id&apos;,as:&apos;user&apos;&#125;),</span><br><span class="line">              &#125;</span><br><span class="line">            ],</span><br><span class="line"></span><br><span class="line">        &#125;);</span><br><span class="line">    //结果    </span><br><span class="line">return  [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;class_id&quot;: &quot;二&quot;,</span><br><span class="line">            &quot;class_name&quot;: &quot;2班&quot;,</span><br><span class="line">            &quot;count&quot;: 1</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;class_id&quot;: &quot;一&quot;,</span><br><span class="line">            &quot;class_name&quot;: &quot;1班&quot;,</span><br><span class="line">            &quot;count&quot;: 2</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br></pre></td></tr></table></figure><h3 id="model-建立外键关系的情况"><a href="#model-建立外键关系的情况" class="headerlink" title="model 建立外键关系的情况"></a>model 建立外键关系的情况</h3><ul><li><p><a href="https://itbilu.com/nodejs/npm/41qaV3czb.html#associations-one-to-one" target="_blank" rel="noopener">https://itbilu.com/nodejs/npm/41qaV3czb.html#associations-one-to-one</a></p></li><li><h4 id="1-1-一对一"><a href="#1-1-一对一" class="headerlink" title="1:1 一对一"></a>1:1 一对一</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"> //建立外键关系</span><br><span class="line">yd_user.associate = function(models)&#123;</span><br><span class="line">      yd_user.belongsTo(models.yd_info,&#123;foreignKey:&apos;info_id&apos;,as:&apos;info&apos;&#125;);  //外键关系 info_id --&gt; id  主键</span><br><span class="line">      yd_user.belongsTo(models.yd_class,&#123;targetKey: &apos;class_id&apos;,foreignKey:&apos;class_id&apos;,as:&apos;class&apos;&#125;); //外键关系 class_id --&gt; class_id 非主键</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">    //外键关系</span><br><span class="line">yd_info.associate = function (models) &#123;</span><br><span class="line">    yd_info.hasOne(models.yd_user,&#123;foreignKey:&apos;info_id&apos;,as:&apos;user&apos;&#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> //测试执行</span><br><span class="line">      let rows = await models.yd_info.findAndCountAll(&#123;  //建立了外键关系</span><br><span class="line">        logging:true,</span><br><span class="line">        attributes:[</span><br><span class="line">            &apos;id&apos;,&apos;age&apos;,&apos;user_name&apos;,&apos;account&apos;</span><br><span class="line">        ],</span><br><span class="line">        raw: true,</span><br><span class="line">        order: [[&apos;id&apos;,&apos;DESC&apos;]],</span><br><span class="line">        where:&#123;id:&apos;1&apos;&#125;, //关联表条件</span><br><span class="line">        include:[</span><br><span class="line">            &#123;</span><br><span class="line">                model:models.yd_user,</span><br><span class="line">                as:&apos;user&apos;,</span><br><span class="line">                attributes:[],</span><br><span class="line">                required:true</span><br><span class="line">            &#125;,</span><br><span class="line"></span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure></li><li><h4 id="1：n-一对多"><a href="#1：n-一对多" class="headerlink" title="1：n 一对多"></a>1：n 一对多</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> //建立外键关系</span><br><span class="line">  yd_user.associate = function(models)&#123;</span><br><span class="line">        yd_user.belongsTo(models.yd_info,&#123;foreignKey:&apos;info_id&apos;,as:&apos;info&apos;&#125;);  //外键关系 info_id --&gt; id  主键</span><br><span class="line">        yd_user.belongsTo(models.yd_class,&#123;targetKey: &apos;class_id&apos;,foreignKey:&apos;class_id&apos;,as:&apos;class&apos;&#125;); //外键关系 class_id --&gt; class_id 非主键</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">yd_class.associate = function(models)&#123;</span><br><span class="line">    yd_class.hasMany(models.yd_user,&#123;sourceKey:&apos;class_id&apos;,foreignKey:&apos;class_id&apos;,as:&apos;user&apos;&#125;); // 多对一  </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  //运行测试</span><br><span class="line">  let rows = await models.yd_class.findAndCountAll(&#123;  //建立了外键关系</span><br><span class="line">            logging:true,</span><br><span class="line">            attributes:[</span><br><span class="line">                &apos;id&apos;,&apos;class_id&apos;,&apos;class_name&apos;</span><br><span class="line">            ],</span><br><span class="line">            raw: true,</span><br><span class="line">            order: [[&apos;id&apos;,&apos;DESC&apos;]],</span><br><span class="line">            where:&#123;class_id:&apos;一&apos;&#125;, //关联表条件</span><br><span class="line">            include:[</span><br><span class="line">                &#123;</span><br><span class="line">                    model:models.yd_user,</span><br><span class="line">                    as:&apos;user&apos;,</span><br><span class="line">                    attributes:[],</span><br><span class="line">                    required:true</span><br><span class="line">                &#125;,</span><br><span class="line"></span><br><span class="line">            ]</span><br><span class="line"></span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;参考资源&quot;&gt;&lt;a href=&quot;#参考资源&quot; class=&quot;headerlink&quot; title=&quot;参考资源&quot;&gt;&lt;/a&gt;参考资源&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://itbilu.com/nodejs/npm/VJIR1CjMb.html&quot; t
      
    
    </summary>
    
    
      <category term="sql" scheme="http://note.yidianwz.com/tags/sql/"/>
    
  </entry>
  
  <entry>
    <title>vue实现自动发卡项目</title>
    <link href="http://note.yidianwz.com/2018/10/12/vue%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%8A%A8%E5%8F%91%E5%8D%A1%E9%A1%B9%E7%9B%AE/"/>
    <id>http://note.yidianwz.com/2018/10/12/vue实现自动发卡项目/</id>
    <published>2018-10-12T02:03:59.000Z</published>
    <updated>2019-05-09T03:11:34.455Z</updated>
    
    <content type="html"><![CDATA[<h1 id="一点发卡"><a href="#一点发卡" class="headerlink" title="一点发卡"></a>一点发卡</h1><p>一点自动发卡 目前已初步开发完成！<br>欢迎<code>issue</code>，<code>pr</code>，<code>star</code> or <code>follow</code>！</p><p>推荐一个之前用Vue 文章类阅读写的 <a href="https://github.com/AntonySufer/vue-cli-yidian" target="_blank" rel="noopener">一点阅读</a></p><p>微信小程序  <a href="https://github.com/AntonySufer/yidianwz_wx" target="_blank" rel="noopener">一点文章</a> 已上线，可以微信搜索 一点文章体验</p><h2 id="在线体验地址"><a href="#在线体验地址" class="headerlink" title="在线体验地址"></a>在线体验地址</h2><p><a href="http://shop.yidianwz.com" target="_blank" rel="noopener">点击这里体验</a>  第一次加载稍慢，请耐心等待</p><h2 id="部分效果截图"><a href="#部分效果截图" class="headerlink" title="部分效果截图"></a>部分效果截图</h2><p><img src="/2018/10/12/vue实现自动发卡项目/1.png" title="首页"> <br><br><img src="/2018/10/12/vue实现自动发卡项目/2.png" title="订单记录"> <br><br><img src="/2018/10/12/vue实现自动发卡项目/3.png" title="店铺首页"> <br></p><h2 id="一点发卡优势"><a href="#一点发卡优势" class="headerlink" title="一点发卡优势"></a>一点发卡优势</h2><p>| 极速发货 |<br>| 自动结算 |<br>| 信息推送 |<br>| 安全保障 |<br>| 弹性负载 | </p><h2 id="使用体验"><a href="#使用体验" class="headerlink" title="使用体验"></a>使用体验</h2><p><a href="http://admin.yidianwz.com/login" target="_blank" rel="noopener">点击这里体验</a>  第一次加载稍慢，请耐心等待</p><h2 id="实现功能模块"><a href="#实现功能模块" class="headerlink" title="实现功能模块"></a>实现功能模块</h2><ul><li style="list-style: none"><input type="checkbox" checked> 用户管理</li><li style="list-style: none"><input type="checkbox" checked> 商品管理</li><li style="list-style: none"><input type="checkbox" checked> 卡密管理</li><li style="list-style: none"><input type="checkbox" checked> 交易管理</li><li style="list-style: none"><input type="checkbox" checked> 商家助手</li></ul><h2 id="一些注意事项"><a href="#一些注意事项" class="headerlink" title="一些注意事项"></a>一些注意事项</h2><ul><li>目前只支持微信和支付宝支付</li></ul><h2 id="支持"><a href="#支持" class="headerlink" title="支持"></a>支持</h2><p>欢迎<code>issue</code>，<code>pr</code>，<code>star</code> or <code>follow</code>！</p><p><a href="https://note.yidianwz.com/2018/10/12/vue%E5%AE%9E%E7%8E%B0%E8%87%AA%E5%8A%A8%E5%8F%91%E5%8D%A1%E9%A1%B9%E7%9B%AE/">你可以在这里打赏我</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;一点发卡&quot;&gt;&lt;a href=&quot;#一点发卡&quot; class=&quot;headerlink&quot; title=&quot;一点发卡&quot;&gt;&lt;/a&gt;一点发卡&lt;/h1&gt;&lt;p&gt;一点自动发卡 目前已初步开发完成！&lt;br&gt;欢迎&lt;code&gt;issue&lt;/code&gt;，&lt;code&gt;pr&lt;/code&gt;，&lt;cod
      
    
    </summary>
    
    
      <category term="vue pay" scheme="http://note.yidianwz.com/tags/vue-pay/"/>
    
  </entry>
  
  <entry>
    <title>一点点餐项目</title>
    <link href="http://note.yidianwz.com/2018/09/06/%E4%B8%80%E7%82%B9%E7%82%B9%E9%A4%90/"/>
    <id>http://note.yidianwz.com/2018/09/06/一点点餐/</id>
    <published>2018-09-06T07:37:31.000Z</published>
    <updated>2019-05-09T03:11:34.531Z</updated>
    
    <content type="html"><![CDATA[<p> 扫码点餐，外卖点餐源码网页<br></p><ul><li>扫码点餐 </li><li>店铺首页推荐</li><li>用户订餐</li><li>提交订单</li><li>支付订单</li><li>订单详情</li><li>订单列表</li><li>个人中心</li><li>店铺详情<br><br></li></ul><p>推荐一个之前用Vue 文章类阅读写的 <a href="https://github.com/AntonySufer/vue-cli-yidian" target="_blank" rel="noopener">一点阅读</a></p><p>微信小程序  <a href="https://github.com/AntonySufer/yidianwz_wx" target="_blank" rel="noopener">一点文章</a> 已上线，可以再微信搜索 一点文章  体验</p><h3 id="扫码体验"><a href="#扫码体验" class="headerlink" title="扫码体验"></a>扫码体验</h3><p><img src="/2018/09/06/一点点餐/qcode.jpg" title="二维码"> <br></p><h2 id="项目示例"><a href="#项目示例" class="headerlink" title="项目示例"></a>项目示例</h2><p><img src="/2018/09/06/一点点餐/1.jpg" title="项目示例"> <br></p><h2 id="项目源码-联系邮箱"><a href="#项目源码-联系邮箱" class="headerlink" title="项目源码 联系邮箱"></a>项目源码 联系邮箱</h2><p><a href="mailto:dian_note@163.com" target="_blank" rel="noopener">dian_note@163.com</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt; 扫码点餐，外卖点餐源码网页&lt;br&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;扫码点餐 &lt;/li&gt;
&lt;li&gt;店铺首页推荐&lt;/li&gt;
&lt;li&gt;用户订餐&lt;/li&gt;
&lt;li&gt;提交订单&lt;/li&gt;
&lt;li&gt;支付订单&lt;/li&gt;
&lt;li&gt;订单详情&lt;/li&gt;
&lt;li&gt;订单列表&lt;/li&gt;
&lt;li&gt;个人中心
      
    
    </summary>
    
    
      <category term="一点点餐项目" scheme="http://note.yidianwz.com/tags/%E4%B8%80%E7%82%B9%E7%82%B9%E9%A4%90%E9%A1%B9%E7%9B%AE/"/>
    
  </entry>
  
  <entry>
    <title>一点小说阅读vue项目源码</title>
    <link href="http://note.yidianwz.com/2018/08/14/%E4%B8%80%E7%82%B9%E5%B0%8F%E8%AF%B4%E9%98%85%E8%AF%BBvue%E9%A1%B9%E7%9B%AE%E6%BA%90%E7%A0%81/"/>
    <id>http://note.yidianwz.com/2018/08/14/一点小说阅读vue项目源码/</id>
    <published>2018-08-14T07:31:40.000Z</published>
    <updated>2019-05-09T03:11:34.505Z</updated>
    
    <content type="html"><![CDATA[<h1 id="vue-reader"><a href="#vue-reader" class="headerlink" title="vue-reader"></a>vue-reader</h1><p>一点阅读器！API源自追书神器，免费使用！目前已初步开发完成！</p><p>Github项目地址:<a href="https://github.com/AntonySufer/vue-readle" target="_blank" rel="noopener">https://github.com/AntonySufer/vue-readle</a></p><p>欢迎<code>issue</code>，<code>pr</code>，<code>star</code> or <code>follow</code>！</p><p>推荐一个之前用Vue 文章类阅读写的 <a href="https://github.com/AntonySufer/vue-cli-yidian" target="_blank" rel="noopener">一点阅读</a></p><p>微信小程序  <a href="https://github.com/AntonySufer/yidianwz_wx" target="_blank" rel="noopener">一点文章</a> 已上线，可以再微信搜索 一点文章体验</p><h2 id="在线体验地址"><a href="#在线体验地址" class="headerlink" title="在线体验地址"></a>在线体验地址</h2><p><a href="https://yidianwz.com/reader/#/" target="_blank" rel="noopener">点击这里体验</a></p><h2 id="部分效果截图"><a href="#部分效果截图" class="headerlink" title="部分效果截图"></a>部分效果截图</h2><img src="/2018/08/14/一点小说阅读vue项目源码/2.jpg" title="项目示例图片"> <br><br><br><br>## 一点阅读器优势<br><br>| 分类 | 一点阅读器 | 追书神器|<br>|—–|———–|———-|<br>|收费 | 免费      |部分章节免费,其余收费|<br>|广告 |绿色无广告 | 定时刷广告|<br>|体积 | 4MB     | 16.2MB   |<br>|章节大小| 每章5kb左右   | 掺杂广告，大于5kb|<br><br><br>## 使用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/AntonySufer/vue-readle.git</span><br><span class="line"></span><br><span class="line">cd vue-readle</span><br><span class="line"></span><br><span class="line">npm install</span><br><span class="line"></span><br><span class="line"># 开发环境</span><br><span class="line">npm run dev</span><br><span class="line">访问 http://localhost:8888/</span><br><span class="line"></span><br><span class="line"># 打包</span><br><span class="line">npm run build</span><br></pre></td></tr></table></figure><h2 id="实现功能"><a href="#实现功能" class="headerlink" title="实现功能"></a>实现功能</h2><ul><li style="list-style: none"><input type="checkbox" checked> 小说搜索</li><li style="list-style: none"><input type="checkbox" checked> 小说详情</li><li style="list-style: none"><input type="checkbox" checked> 小说换源</li><li style="list-style: none"><input type="checkbox" checked> 小说阅读</li><li style="list-style: none"><input type="checkbox" checked> 阅读字体大小变化</li><li style="list-style: none"><input type="checkbox" checked> 阅读背景色变化</li><li style="list-style: none"><input type="checkbox" checked> 阅读设置本地缓存</li><li style="list-style: none"><input type="checkbox" checked> 阅读进度本地缓存</li><li style="list-style: none"><input type="checkbox" checked> 搜索历史本地缓存</li></ul><p>每次进入首页自动刷新最新章节列表</p><h2 id="一些注意事项"><a href="#一些注意事项" class="headerlink" title="一些注意事项"></a>一些注意事项</h2><p>项目中使用追书神器的接口，需要使用<code>http-proxy-middleware</code>进行转发，开发环境下需要在<code>cfg/base.js</code>中的<code>dev</code>中添加下列配置即可<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">proxy: &#123;</span><br><span class="line">  &apos;/api&apos;: &#123;</span><br><span class="line">    target: &apos;http://api.zhuishushenqi.com/&apos;,</span><br><span class="line">    pathRewrite: &#123;&apos;^/api&apos; : &apos;/&apos;&#125;,</span><br><span class="line">    changeOrigin: true</span><br><span class="line">  &#125;,</span><br><span class="line">  &apos;/chapter&apos;: &#123;</span><br><span class="line">    target: &apos;http://chapter2.zhuishushenqi.com/&apos;,</span><br><span class="line">    pathRewrite: &#123;&apos;^/chapter&apos; : &apos;/chapter&apos;&#125;,</span><br><span class="line">    changeOrigin: true</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>实际环境中，服务器端配置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">var express = require(&apos;express&apos;);</span><br><span class="line">var proxy = require(&apos;http-proxy-middleware&apos;);</span><br><span class="line"></span><br><span class="line">var app = express();</span><br><span class="line">app.use(&apos;/static&apos;, express.static(&apos;static&apos;));</span><br><span class="line">app.use(&apos;/assets&apos;, express.static(&apos;assets&apos;));</span><br><span class="line">app.use(&apos;/api&apos;, proxy(&#123;</span><br><span class="line">  target: &apos;http://api.zhuishushenqi.com/&apos;,</span><br><span class="line">  pathRewrite: &#123;&apos;^/api&apos; : &apos;/&apos;&#125;,</span><br><span class="line">  changeOrigin: true</span><br><span class="line">&#125;</span><br><span class="line">));</span><br><span class="line"></span><br><span class="line">app.use(&apos;/chapter&apos;, proxy(&#123;</span><br><span class="line">  target: &apos;http://chapter2.zhuishushenqi.com/&apos;,</span><br><span class="line">  pathRewrite: &#123;&apos;^/chapter&apos; : &apos;/chapter&apos;&#125;,</span><br><span class="line">  changeOrigin: true</span><br><span class="line">&#125;</span><br><span class="line">));</span><br></pre></td></tr></table></figure></p><h2 id="支持"><a href="#支持" class="headerlink" title="支持"></a>支持</h2><p>欢迎<code>issue</code>，<code>pr</code>，<code>star</code> or <code>follow</code>！</p><p><a href="https://note.yidianwz.com/2018/08/08/%E4%B8%80%E7%82%B9%E5%B0%8F%E8%AF%B4/">你可以在这里打赏我</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;vue-reader&quot;&gt;&lt;a href=&quot;#vue-reader&quot; class=&quot;headerlink&quot; title=&quot;vue-reader&quot;&gt;&lt;/a&gt;vue-reader&lt;/h1&gt;&lt;p&gt;一点阅读器！API源自追书神器，免费使用！目前已初步开发完成！&lt;/p&gt;
&lt;p
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>一点文章小程序源码</title>
    <link href="http://note.yidianwz.com/2018/07/27/%E4%B8%80%E7%82%B9%E6%96%87%E7%AB%A0%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%BA%90%E7%A0%81/"/>
    <id>http://note.yidianwz.com/2018/07/27/一点文章小程序源码/</id>
    <published>2018-07-27T02:24:09.000Z</published>
    <updated>2019-05-09T03:11:34.516Z</updated>
    
    <content type="html"><![CDATA[<p>历时一个星期开发到正式上线。<br></p><ul><li>实现侧滑菜单 </li><li>html编译</li><li>数据列表</li><li>用户登录权限</li><li>分享朋友圈和好友</li><li>评论功能<br><br><br>###更新版本1.0.3<br><img src="/2018/07/27/一点文章小程序源码/share.png" title="二维码"> <br></li></ul><h3 id="扫码体验"><a href="#扫码体验" class="headerlink" title="扫码体验"></a>扫码体验</h3><p><img src="/2018/07/27/一点文章小程序源码/img1.jpg" title="二维码"> <br></p><h2 id="项目示例"><a href="#项目示例" class="headerlink" title="项目示例"></a>项目示例</h2><p><img src="/2018/07/27/一点文章小程序源码/img5.jpg" title="项目示例"> <br></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;历时一个星期开发到正式上线。&lt;br&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;实现侧滑菜单 &lt;/li&gt;
&lt;li&gt;html编译&lt;/li&gt;
&lt;li&gt;数据列表&lt;/li&gt;
&lt;li&gt;用户登录权限&lt;/li&gt;
&lt;li&gt;分享朋友圈和好友&lt;/li&gt;
&lt;li&gt;评论功能&lt;br&gt;&lt;br&gt;&lt;br&gt;###更新版本1
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>vue-cli-domo 项目源码实现</title>
    <link href="http://note.yidianwz.com/2018/07/27/vue-cli-domo-%E6%BA%90%E7%A0%81/"/>
    <id>http://note.yidianwz.com/2018/07/27/vue-cli-domo-源码/</id>
    <published>2018-07-27T02:00:08.000Z</published>
    <updated>2019-05-09T03:11:34.442Z</updated>
    
    <content type="html"><![CDATA[<h1 id="项目源码"><a href="#项目源码" class="headerlink" title="项目源码"></a>项目源码</h1><p> <a href="https://github.com/AntonySufer/vue-cli-yidian" target="_blank" rel="noopener">github源码地址</a></p><h1 id="项目示例"><a href="#项目示例" class="headerlink" title="项目示例"></a>项目示例</h1><p><img src="/2018/07/27/vue-cli-domo-源码/1.jpg" title="项目示例图片"> <br></p><h1 id="技术支持"><a href="#技术支持" class="headerlink" title="技术支持"></a>技术支持</h1><ul><li>vue-cli2.0</li><li>webpack</li><li>better-scroll</li></ul><h1 id="install-dependencies"><a href="#install-dependencies" class="headerlink" title="install dependencies"></a>install dependencies</h1><p>npm install</p><h1 id="serve-with-hot-reload-at-localhost-8081-config-index-js切换端口"><a href="#serve-with-hot-reload-at-localhost-8081-config-index-js切换端口" class="headerlink" title="serve with hot reload at localhost:8081(/config/index.js切换端口)"></a>serve with hot reload at localhost:8081(/config/index.js切换端口)</h1><p>npm run dev</p><h1 id="build-for-production-with-minification"><a href="#build-for-production-with-minification" class="headerlink" title="build for production with minification"></a>build for production with minification</h1><p>npm run build</p><h1 id="build-for-production-and-view-the-bundle-analyzer-report"><a href="#build-for-production-and-view-the-bundle-analyzer-report" class="headerlink" title="build for production and view the bundle analyzer report"></a>build for production and view the bundle analyzer report</h1><p>npm run build –report</p><h1 id="run-e2e-tests"><a href="#run-e2e-tests" class="headerlink" title="run e2e tests"></a>run e2e tests</h1><p>npm run e2e</p><h1 id="run-all-tests"><a href="#run-all-tests" class="headerlink" title="run all tests"></a>run all tests</h1><p>npm test</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;项目源码&quot;&gt;&lt;a href=&quot;#项目源码&quot; class=&quot;headerlink&quot; title=&quot;项目源码&quot;&gt;&lt;/a&gt;项目源码&lt;/h1&gt;&lt;p&gt; &lt;a href=&quot;https://github.com/AntonySufer/vue-cli-yidian&quot; targe
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>自己css常用样式</title>
    <link href="http://note.yidianwz.com/2018/05/09/css%E5%B8%B8%E7%94%A8%E6%A0%B7%E5%BC%8F/"/>
    <id>http://note.yidianwz.com/2018/05/09/css常用样式/</id>
    <published>2018-05-09T07:22:15.000Z</published>
    <updated>2019-05-09T03:11:34.372Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-设置图片等比例缩放-背景"><a href="#1-设置图片等比例缩放-背景" class="headerlink" title="1.设置图片等比例缩放 背景"></a>1.设置图片等比例缩放 背景</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">background: url('/public/img/bg1.png') no-repeat center top;</span><br><span class="line"><span class="selector-tag">background-size</span>: 100%;</span><br></pre></td></tr></table></figure><h2 id="2-设置button-点击样式"><a href="#2-设置button-点击样式" class="headerlink" title="2.设置button 点击样式"></a>2.设置button 点击样式</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> <span class="selector-class">.ripple</span> &#123;</span><br><span class="line">     <span class="attribute">position</span>: relative;</span><br><span class="line">     //隐藏溢出的径向渐变背景</span><br><span class="line">     <span class="selector-tag">overflow</span>: <span class="selector-tag">hidden</span>;</span><br><span class="line">   &#125;</span><br><span class="line"><span class="selector-class">.ripple</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">     <span class="attribute">content</span>: <span class="string">""</span>;</span><br><span class="line">     <span class="attribute">display</span>: block;</span><br><span class="line">     <span class="attribute">position</span>: absolute;</span><br><span class="line">     <span class="attribute">width</span>: <span class="built_in">p2m</span>(100px);</span><br><span class="line">     <span class="attribute">height</span>: <span class="built_in">p2m</span>(100px);</span><br><span class="line">     <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">     <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">     <span class="attribute">pointer-events</span>: none;</span><br><span class="line">     //设置径向渐变</span><br><span class="line">     <span class="selector-tag">background-image</span>: <span class="selector-tag">radial-gradient</span>(<span class="selector-tag">circle</span>,<span class="selector-id">#F5F5F5</span> 10%, <span class="selector-tag">transparent</span> 10<span class="selector-class">.01</span>%);</span><br><span class="line">     <span class="selector-tag">background-repeat</span>: <span class="selector-tag">no-repeat</span>;</span><br><span class="line">     <span class="selector-tag">background-position</span>: 50%;</span><br><span class="line">     <span class="selector-tag">transform</span>: <span class="selector-tag">scale</span>(10, 10);</span><br><span class="line">     <span class="selector-tag">opacity</span>: 0;</span><br><span class="line">     <span class="selector-tag">transition</span>: <span class="selector-tag">transform</span> <span class="selector-class">.3s</span>, <span class="selector-tag">opacity</span> <span class="selector-class">.5s</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="selector-class">.ripple</span><span class="selector-pseudo">:active</span><span class="selector-pseudo">:after</span> &#123;</span><br><span class="line">     <span class="attribute">transform</span>: <span class="built_in">scale</span>(0, 0);</span><br><span class="line">     <span class="attribute">opacity</span>: .<span class="number">3</span>;</span><br><span class="line">     //设置初始状态</span><br><span class="line">     <span class="selector-tag">transition</span>: 0<span class="selector-tag">s</span>;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h2 id="2-1-点击样式"><a href="#2-1-点击样式" class="headerlink" title="2-1 点击样式"></a>2-1 点击样式</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*  &lt;!-- 这边是按下后的效果--&gt;*/</span></span><br><span class="line">    &amp;<span class="selector-pseudo">:active</span> &#123;</span><br><span class="line">      <span class="attribute">padding-bottom</span>:<span class="built_in">p2m</span>(1px);</span><br><span class="line">      <span class="attribute">padding-left</span>:<span class="built_in">p2m</span>(1px);</span><br><span class="line">      <span class="attribute">padding-right</span>:<span class="built_in">p2m</span>(1px);</span><br><span class="line">      <span class="attribute">padding-top</span>:<span class="built_in">p2m</span>(1px);                    <span class="comment">/*  &lt;!-- 上面是按下文字偏移的像素--&gt;*/</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="3-设置渐变样式"><a href="#3-设置渐变样式" class="headerlink" title="3. 设置渐变样式"></a>3. 设置渐变样式</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.gradient</span>&#123;</span><br><span class="line">   <span class="attribute">filter</span>:<span class="built_in">alpha</span>(opacity=100 finishopacity=50 style=1 startx=0,starty=0,finishx=0,finishy=150) progid:DXImageTransform.Microsoft.<span class="built_in">gradient</span>(startcolorstr=#ffffff,endcolorstr=#FFDAD6,gradientType=0);</span><br><span class="line">   <span class="attribute">-ms-filter</span>:<span class="built_in">alpha</span>(opacity=100 finishopacity=50 style=1 startx=0,starty=0,finishx=0,finishy=150) progid:DXImageTransform.Microsoft.<span class="built_in">gradient</span>(startcolorstr=#ffffff,endcolorstr=#FFDAD6,gradientType=0);<span class="comment">/*IE8*/</span></span><br><span class="line">   <span class="attribute">background</span>:<span class="number">#ffffff</span>; <span class="comment">/* 一些不支持背景渐变的浏览器 */</span></span><br><span class="line">   <span class="attribute">background</span>:<span class="built_in">-moz-linear-gradient</span>(top, #ffffff, #FFDAD6);</span><br><span class="line">   <span class="attribute">background</span>:<span class="built_in">-webkit-gradient</span>(linear, 0 0, 0 bottom, from(#ffffff), <span class="built_in">to</span>(#FFDAD6));</span><br><span class="line">   <span class="attribute">background</span>:<span class="built_in">-o-linear-gradient</span>(top, #ffffff, #FFDAD6);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h2 id="4-设置字两边被横线分割"><a href="#4-设置字两边被横线分割" class="headerlink" title="4. 设置字两边被横线分割"></a>4. 设置字两边被横线分割</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.onpure_title</span>&#123;</span><br><span class="line">        <span class="attribute">line-height</span>: <span class="built_in">p2m</span>(100px);</span><br><span class="line">        <span class="comment">/*伪元素实现*/</span></span><br><span class="line"></span><br><span class="line">        .margin-l&#123;</span><br><span class="line">           <span class="selector-tag">margin-left</span>: <span class="selector-tag">p2m</span>(38<span class="selector-tag">px</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="selector-class">.margin-r</span>&#123;</span><br><span class="line">          <span class="attribute">margin-right</span>: <span class="built_in">p2m</span>(38px);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.onpure-icon</span>&#123;</span><br><span class="line">            <span class="attribute">display</span>: inline-block;</span><br><span class="line">            <span class="attribute">height</span>: <span class="built_in">p2m</span>(14px);</span><br><span class="line">            <span class="attribute">width</span>: <span class="built_in">p2m</span>(14px);</span><br><span class="line">            <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">'/public/img/fendd@2x.png'</span>)  center;</span><br><span class="line">            <span class="attribute">background-size</span>: contain;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &amp;<span class="selector-pseudo">:before</span>&#123;</span><br><span class="line">          <span class="attribute">display</span>: inline-block;</span><br><span class="line">          <span class="attribute">position</span>: relative;</span><br><span class="line">          <span class="attribute">top</span>:<span class="built_in">p2m</span>(-8px);</span><br><span class="line">          <span class="attribute">right</span>: <span class="built_in">p2m</span>(20px);</span><br><span class="line">          <span class="attribute">content</span>: <span class="string">""</span>;</span><br><span class="line">          <span class="attribute">width</span>: <span class="built_in">p2m</span>(150px);</span><br><span class="line">          <span class="attribute">height</span>: <span class="number">0px</span>;</span><br><span class="line">          <span class="attribute">border</span>: <span class="built_in">p2m</span>(2px) solid <span class="number">#fff</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &amp;<span class="selector-pseudo">:after</span>&#123;</span><br><span class="line">          <span class="attribute">display</span>: inline-block;</span><br><span class="line">          <span class="attribute">position</span>: relative;</span><br><span class="line">          <span class="attribute">top</span>:<span class="built_in">p2m</span>(-8px);</span><br><span class="line">          <span class="attribute">left</span>: <span class="built_in">p2m</span>(20px);</span><br><span class="line">          <span class="attribute">content</span>: <span class="string">""</span>;</span><br><span class="line">          <span class="attribute">width</span>: <span class="built_in">p2m</span>(150px);</span><br><span class="line">          <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">          <span class="attribute">height</span>: <span class="number">0px</span>;</span><br><span class="line">          <span class="attribute">border</span>: <span class="built_in">p2m</span>(2px) solid <span class="number">#fff</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">    效果：  <span class="selector-tag">exp</span>  ———— <span class="selector-tag">aaa</span> ————————</span><br></pre></td></tr></table></figure><h2 id="5设置-文字内阴影"><a href="#5设置-文字内阴影" class="headerlink" title="5设置 文字内阴影"></a>5设置 文字内阴影</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.fri-tit</span>&#123;</span><br><span class="line">  <span class="attribute">font-size</span>:<span class="built_in">p2m</span>(30px);</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#FF5655</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="built_in">p2m</span>(60px);</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="built_in">p2m</span>(60px);</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  span&#123;</span><br><span class="line">    <span class="selector-tag">-moz-box-shadow</span><span class="selector-pseudo">:0em</span> <span class="selector-tag">p2m</span>(<span class="selector-tag">-20px</span>) <span class="selector-tag">p2m</span>(3<span class="selector-tag">px</span>)  <span class="selector-id">#FFE5E5</span> <span class="selector-tag">inset</span> ;</span><br><span class="line">    <span class="selector-tag">-webkit-box-shadow</span><span class="selector-pseudo">:0em</span> <span class="selector-tag">p2m</span>(<span class="selector-tag">-20px</span>) <span class="selector-tag">p2m</span>(3<span class="selector-tag">px</span>)  <span class="selector-id">#FFE5E5</span> <span class="selector-tag">inset</span>;</span><br><span class="line">     <span class="selector-tag">box-shadow</span><span class="selector-pseudo">:0em</span> <span class="selector-tag">p2m</span>(<span class="selector-tag">-20px</span>) <span class="selector-tag">p2m</span>(3<span class="selector-tag">px</span>)  <span class="selector-id">#FFE5E5</span> <span class="selector-tag">inset</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">   &lt;p class="fri-tit"&gt;&lt;span&gt;活动说明&lt;/span&gt;&lt;/p&gt;</span><br></pre></td></tr></table></figure><h2 id="5设置-p显示几行并且超出省略"><a href="#5设置-p显示几行并且超出省略" class="headerlink" title="5设置 p显示几行并且超出省略"></a>5设置 p显示几行并且超出省略</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">p</span>&#123;</span><br><span class="line">   <span class="attribute">font-size</span>:<span class="built_in">p2m</span>(30px);</span><br><span class="line">   <span class="attribute">height</span>: <span class="built_in">p2m</span>(117px);</span><br><span class="line">   <span class="attribute">overflow </span>: hidden;</span><br><span class="line">   <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">   <span class="attribute">display</span>: -webkit-box;</span><br><span class="line">   <span class="attribute">-webkit-line-clamp</span>:<span class="number">3</span>;</span><br><span class="line">   <span class="attribute">-webkit-box-orient</span>: vertical;</span><br><span class="line"> &#125;;</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">   &lt;p class="fri-tit"&gt;活活动说明活动说明活动说明活动说明动说明&lt;/p&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;1-设置图片等比例缩放-背景&quot;&gt;&lt;a href=&quot;#1-设置图片等比例缩放-背景&quot; class=&quot;headerlink&quot; title=&quot;1.设置图片等比例缩放 背景&quot;&gt;&lt;/a&gt;1.设置图片等比例缩放 背景&lt;/h2&gt;&lt;figure class=&quot;highlight 
      
    
    </summary>
    
    
      <category term="css" scheme="http://note.yidianwz.com/tags/css/"/>
    
  </entry>
  
  <entry>
    <title>解决vue单页首次加载慢问题</title>
    <link href="http://note.yidianwz.com/2018/04/19/%E8%A7%A3%E5%86%B3vue%E5%8D%95%E9%A1%B5%E9%A6%96%E6%AC%A1%E5%8A%A0%E8%BD%BD%E6%85%A2%E9%97%AE%E9%A2%98/"/>
    <id>http://note.yidianwz.com/2018/04/19/解决vue单页首次加载慢问题/</id>
    <published>2018-04-19T08:01:33.000Z</published>
    <updated>2019-05-09T03:11:34.595Z</updated>
    
    <content type="html"><![CDATA[<h1 id="步骤一-vue-cli开启打包压缩-和后台配合-gzip访问"><a href="#步骤一-vue-cli开启打包压缩-和后台配合-gzip访问" class="headerlink" title="步骤一 vue-cli开启打包压缩 和后台配合 gzip访问"></a>步骤一 vue-cli开启打包压缩 和后台配合 gzip访问</h1><h4 id="1-首先打开-config-index-js-，找到-build-对象中的-productionGzip-，改成-true"><a href="#1-首先打开-config-index-js-，找到-build-对象中的-productionGzip-，改成-true" class="headerlink" title="1.首先打开 config/index.js ，找到 build 对象中的 productionGzip ，改成 true"></a>1.首先打开 config/index.js ，找到 build 对象中的 productionGzip ，改成 true</h4><h4 id="2-打开-productionGzip-true-之前，先要安装依赖-compression-webpack-plugin-，官方推荐的命令是："><a href="#2-打开-productionGzip-true-之前，先要安装依赖-compression-webpack-plugin-，官方推荐的命令是：" class="headerlink" title="2.  打开 productionGzip: true 之前，先要安装依赖 compression-webpack-plugin ，官方推荐的命令是："></a>2.  打开 productionGzip: true 之前，先要安装依赖 compression-webpack-plugin ，官方推荐的命令是：</h4> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev compression-webpack-plugin </span><br><span class="line">//(此处有坑) 如果打包报错，应该是版本问题 ，先卸载之前安装的此插件 ，然后安装低版本 </span><br><span class="line"> npm install --save-dev compression-webpack-plugin@1.1.11</span><br></pre></td></tr></table></figure><h4 id="3-等安装好了，重新打包-npm-run-build-，此时打包的文件会-新增-gz-文件。是不是比原来的js文件小很多呢，之后项目访问的文件就是这个-gz文件-。"><a href="#3-等安装好了，重新打包-npm-run-build-，此时打包的文件会-新增-gz-文件。是不是比原来的js文件小很多呢，之后项目访问的文件就是这个-gz文件-。" class="headerlink" title="3.等安装好了，重新打包 npm run build ，此时打包的文件会 新增  .gz 文件。是不是比原来的js文件小很多呢，之后项目访问的文件就是这个.gz文件 。"></a>3.等安装好了，重新打包 npm run build ，此时打包的文件会 新增  .gz 文件。是不是比原来的js文件小很多呢，之后项目访问的文件就是这个.gz文件 。</h4><h4 id="4-后台nginx开启gzip模式访问，浏览器访问项目，自动会找到-gz-的文件。加载速度明显提高。"><a href="#4-后台nginx开启gzip模式访问，浏览器访问项目，自动会找到-gz-的文件。加载速度明显提高。" class="headerlink" title="4.后台nginx开启gzip模式访问，浏览器访问项目，自动会找到 .gz 的文件。加载速度明显提高。"></a>4.后台nginx开启gzip模式访问，浏览器访问项目，自动会找到 .gz 的文件。加载速度明显提高。</h4><ul><li>开启 nginx gzip ,在 nginx.conf 配置文件中 配置<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">http &#123;  //在 http中配置如下代码，</span><br><span class="line">  </span><br><span class="line">   gzip on;</span><br><span class="line">   gzip_disable &quot;msie6&quot;; </span><br><span class="line">   gzip_vary on; </span><br><span class="line">   gzip_proxied any;</span><br><span class="line">   gzip_comp_level 8; #压缩级别</span><br><span class="line">   gzip_buffers 16 8k;</span><br><span class="line">   #gzip_http_version 1.1;</span><br><span class="line">   gzip_min_length 100; #不压缩临界值</span><br><span class="line">   gzip_types text/plain application/javascript application/x-javascript text/css application/xml text/javascript application/x-httpd-php image/jpeg image/gif image/png;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></li></ul><ul><li>保存退出  ，并 重启 nginx <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl reload nginx.service  </span><br><span class="line">systemctl restart nginx.service</span><br></pre></td></tr></table></figure></li></ul><h4 id="5-测试访问"><a href="#5-测试访问" class="headerlink" title="5 测试访问"></a>5 测试访问</h4><ul><li><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -I -H &quot;Accept-Encoding: gzip, deflate&quot; &quot;http://xxx.com&quot;  //访问请求中 Content-Encoding: gzip 表示 压缩成功页面，</span><br></pre></td></tr></table></figure></li><li><p>同理 访问js，css等 可测试 是否压缩成功.<br><br></p></li></ul><h4 id="6-正式访问项目，此时项目加载速度明显提升"><a href="#6-正式访问项目，此时项目加载速度明显提升" class="headerlink" title="6 正式访问项目，此时项目加载速度明显提升"></a>6 正式访问项目，此时项目加载速度明显提升</h4><h1 id="步骤二-webpack来打包vue项目，vendor-js过大问题解决"><a href="#步骤二-webpack来打包vue项目，vendor-js过大问题解决" class="headerlink" title="步骤二 webpack来打包vue项目，vendor.js过大问题解决"></a>步骤二 webpack来打包vue项目，vendor.js过大问题解决</h1><h4 id="1-造成过大的原因是因为在main-js导入第三库太多时-webpack合并js时生成了vendor-js-我们习惯把第三方库放在vendor里面-造成的-如下图在main-js引用element-ui等第三方库。后果就是你的服务器端的js文件越大则用户加载页面的时间会越长-因为所需下载js的时间越久"><a href="#1-造成过大的原因是因为在main-js导入第三库太多时-webpack合并js时生成了vendor-js-我们习惯把第三方库放在vendor里面-造成的-如下图在main-js引用element-ui等第三方库。后果就是你的服务器端的js文件越大则用户加载页面的时间会越长-因为所需下载js的时间越久" class="headerlink" title="1.造成过大的原因是因为在main.js导入第三库太多时,webpack合并js时生成了vendor.js(我们习惯把第三方库放在vendor里面)造成的.如下图在main.js引用element-ui等第三方库。后果就是你的服务器端的js文件越大则用户加载页面的时间会越长(因为所需下载js的时间越久)"></a>1.造成过大的原因是因为在main.js导入第三库太多时,webpack合并js时生成了vendor.js(我们习惯把第三方库放在vendor里面)造成的.如下图在main.js引用element-ui等第三方库。后果就是你的服务器端的js文件越大则用户加载页面的时间会越长(因为所需下载js的时间越久)</h4><p><img src="/2018/04/19/解决vue单页首次加载慢问题/main.png"> <br></p><h4 id="2-解决方案-采用cdn加速去从别的服务器上加载第三方库而非自己的服务器，这样就会快很多-并且能节省自己服务器的带宽。"><a href="#2-解决方案-采用cdn加速去从别的服务器上加载第三方库而非自己的服务器，这样就会快很多-并且能节省自己服务器的带宽。" class="headerlink" title="2.解决方案:采用cdn加速去从别的服务器上加载第三方库而非自己的服务器，这样就会快很多.并且能节省自己服务器的带宽。"></a>2.解决方案:采用cdn加速去从别的服务器上加载第三方库而非自己的服务器，这样就会快很多.并且能节省自己服务器的带宽。</h4><ul><li>选用unpkg来作为第三方提供  <a href="https://unpkg.com" target="_blank" rel="noopener">https://unpkg.com</a> 或者 <a href="https://www.bootcdn.cn/" target="_blank" rel="noopener">https://www.bootcdn.cn/</a>  </li><li>如我想要axios包则输入网址为 <a href="https://unpkg.com/axios/" target="_blank" rel="noopener">https://unpkg.com/axios/</a> (末尾加斜杠代表你要查询该库的所有版本列表)</li><li>在index.html中 将你所需的第三方库的链接加载进来,如下图:<br><img src="/2018/04/19/解决vue单页首次加载慢问题/cdn.png"> <br></li><li>在webpack.base.conf 中添加 externals 来告诉webpack我们这些第三方库不需要打包 如下图<br><img src="/2018/04/19/解决vue单页首次加载慢问题/config.png"> <br></li><li><p>在 主文件main.js 或者其他 js 修改引用这些配置的第三方插件 ，如图：<br><img src="/2018/04/19/解决vue单页首次加载慢问题/exp1.png"> <br><br><img src="/2018/04/19/解决vue单页首次加载慢问题/exp2.png"> <br></p></li><li><p>执行npm run build 来验证是否减小了。自己测试项目   vendor.js 由原来的 600k，减少到 100k</p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;步骤一-vue-cli开启打包压缩-和后台配合-gzip访问&quot;&gt;&lt;a href=&quot;#步骤一-vue-cli开启打包压缩-和后台配合-gzip访问&quot; class=&quot;headerlink&quot; title=&quot;步骤一 vue-cli开启打包压缩 和后台配合 gzip访问&quot;&gt;
      
    
    </summary>
    
    
      <category term="vue webpack 单页面" scheme="http://note.yidianwz.com/tags/vue-webpack-%E5%8D%95%E9%A1%B5%E9%9D%A2/"/>
    
  </entry>
  
  <entry>
    <title>node-express主文件实现上传 视频 和图片 保存</title>
    <link href="http://note.yidianwz.com/2018/01/11/node-express%E4%B8%BB%E6%96%87%E4%BB%B6%E5%AE%9E%E7%8E%B0%E4%B8%8A%E4%BC%A0api/"/>
    <id>http://note.yidianwz.com/2018/01/11/node-express主文件实现上传api/</id>
    <published>2018-01-11T03:43:11.000Z</published>
    <updated>2019-05-09T03:11:34.405Z</updated>
    
    <content type="html"><![CDATA[<h1 id="文件上传app-设置"><a href="#文件上传app-设置" class="headerlink" title="文件上传app 设置"></a>文件上传app 设置</h1><ul><li>前端通过上传插件调用 </li><li>视频 /upload_movie </li><li>图片 /temp  </li><li>项目根目录创建 temp 文件夹</li></ul><h2 id="视频"><a href="#视频" class="headerlink" title="视频"></a>视频</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">//form表单需要的中间件。</span><br><span class="line">var mutipart= require(&apos;connect-multiparty&apos;); //表单中间件</span><br><span class="line">var ffmpeg = require(&apos;fluent-ffmpeg&apos;);//转码插件</span><br><span class="line"></span><br><span class="line">var mutipartMiddeware = mutipart();</span><br><span class="line">app.use(mutipart(&#123;uploadDir:__dirname + &quot;/temp/&quot;&#125;)); //设置文件存储位置</span><br><span class="line"></span><br><span class="line">//这里就是接受form表单请求的接口路径，请求方式为post。</span><br><span class="line">app.post(&apos;/upload_movie&apos;,mutipartMiddeware,function (req,res) &#123;</span><br><span class="line">    var data = &#123;&#125;;</span><br><span class="line">    //成功接受到浏览器传来的文件。我们可以在这里写对文件的一系列操作。例如重命名，修改文件储存路径 。等等。</span><br><span class="line">    var files = req.files.files[0];</span><br><span class="line">    console.log(files);</span><br><span class="line">    //压缩视频</span><br><span class="line">    var file_path =files.path;</span><br><span class="line">    var file_name =files.originalFilename;//名称</span><br><span class="line">    var name_temp =new Date().valueOf();</span><br><span class="line">    var newpath = path.normalize(__dirname + &apos;/temp/&apos;+name_temp+&apos;.mp4&apos;);</span><br><span class="line">     //判断是不是mp4</span><br><span class="line">        var bitrate =files.size;</span><br><span class="line">        //size 大于5M 压缩</span><br><span class="line">        if(bitrate &gt;5242880) &#123;</span><br><span class="line">            var trans = new ffmpeg(&#123;source: file_path&#125;)</span><br><span class="line">                    .setFfmpegPath(__dirname + &apos;/temp/ffmepg/bin/ffmpeg.exe&apos;) //转码执行文件</span><br><span class="line">                    .videoBitrate(&apos;2000k&apos;, true)</span><br><span class="line">                    .format(&apos;mp4&apos;)  //转码格式</span><br><span class="line">                    .save(newpath)</span><br><span class="line">                    .on(&apos;end&apos;, function () &#123; //转码完成</span><br><span class="line">                        console.log(&apos;转码完成!&apos;);</span><br><span class="line">                        //删除源文件</span><br><span class="line">                        fs.unlink(file_path);//fs.unlink 删除用户上传的文件</span><br><span class="line">                        data.newpath = newpath;</span><br><span class="line">                        data.状态 = &apos;成功&apos;;</span><br><span class="line">                        res.send(data).end();</span><br><span class="line">                    &#125;)</span><br><span class="line">                    .on(&apos;progress&apos;, function (progress) &#123;</span><br><span class="line">                        //进度条</span><br><span class="line">                        console.log(&apos;上传中。。。&apos;);</span><br><span class="line">                    &#125;)</span><br><span class="line">                    /* .screenshots(&#123; //截图</span><br><span class="line">                     //  timestamps: [30.5, &apos;50%&apos;, &apos;01:10.123&apos;],</span><br><span class="line">                     count: 1,</span><br><span class="line">                     filename: name_temp+&apos;.png&apos;,</span><br><span class="line">                     folder: __dirname + &apos;/temp/&apos;</span><br><span class="line">                     &#125;);*/</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            //小于直接上传</span><br><span class="line">            console.log(file_path);</span><br><span class="line">            data.newpath = file_path;</span><br><span class="line">            data.状态 = &apos;成功&apos;;</span><br><span class="line">            res.send(data).end();</span><br><span class="line">        &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="图片上传"><a href="#图片上传" class="headerlink" title="图片上传"></a>图片上传</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">//文件上传</span><br><span class="line">var formidable = require(&apos;formidable&apos;);</span><br><span class="line">app.post(&quot;/temp&quot;,function(req,res)&#123;</span><br><span class="line">    var data = &#123;&#125;;</span><br><span class="line">    var form = new formidable.IncomingForm();//实例化formidable对象</span><br><span class="line">    var dir = path.normalize(__dirname + &quot;/temp/&quot;);//路径</span><br><span class="line">    form.uploadDir = dir;//更改上传地址</span><br><span class="line">    if(fs.existsSync(dir) == false) &#123;</span><br><span class="line">        fs.mkdirSync(dir);</span><br><span class="line">    &#125;</span><br><span class="line">    form.parse(req, function(err, fields, files) &#123;//图片传入及解析</span><br><span class="line">        if(err) &#123;</span><br><span class="line">            data.状态 = &apos;文件保存失败&apos;;</span><br><span class="line">            res.send(data).end();</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            var length = 0;</span><br><span class="line">            for (item in files) &#123;</span><br><span class="line">                length++;</span><br><span class="line">            &#125;</span><br><span class="line">            if (length === 0) &#123;</span><br><span class="line">                data.状态 = &apos;文件保存失败&apos;;</span><br><span class="line">                res.send(data).end();</span><br><span class="line">                return;</span><br><span class="line">            &#125;</span><br><span class="line">            for (item in files) &#123;</span><br><span class="line">                var file = files[item];</span><br><span class="line">                var type = file.name.split(&apos;.&apos;)[1];</span><br><span class="line">                var ttt = moment().format(&quot;YYYYMMDDHHmmss&quot;);</span><br><span class="line">                var ran = parseInt(Math.random() * 89999 + 10000);</span><br><span class="line">                var oldpath = file.path;</span><br><span class="line">                var newName = ttt + ran;</span><br><span class="line">                var newpath = path.normalize(__dirname + &quot;/temp/&quot; + newName + &quot;.&quot; + type);</span><br><span class="line">                fs.rename(oldpath, newpath, function(err) &#123;</span><br><span class="line">                    if(err) &#123;</span><br><span class="line">                        data.状态 = &apos;文件改名失败&apos;;</span><br><span class="line">                        res.send(data).end();</span><br><span class="line">                    &#125; else &#123;</span><br><span class="line">                        data.状态 = &apos;成功&apos;;</span><br><span class="line">                        data.newpath = newpath;</span><br><span class="line">                        res.send(data).end();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;文件上传app-设置&quot;&gt;&lt;a href=&quot;#文件上传app-设置&quot; class=&quot;headerlink&quot; title=&quot;文件上传app 设置&quot;&gt;&lt;/a&gt;文件上传app 设置&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;前端通过上传插件调用 &lt;/li&gt;
&lt;li&gt;视频 /upload_
      
    
    </summary>
    
    
      <category term="node express" scheme="http://note.yidianwz.com/tags/node-express/"/>
    
  </entry>
  
  <entry>
    <title>html js 实现全国城市自定位天气</title>
    <link href="http://note.yidianwz.com/2017/12/12/%E5%AE%9E%E7%8E%B0%E5%85%A8%E5%9B%BD%E8%87%AA%E5%AE%9A%E4%BD%8D%E5%A4%A9%E6%B0%94/"/>
    <id>http://note.yidianwz.com/2017/12/12/实现全国自定位天气/</id>
    <published>2017-12-12T03:42:21.000Z</published>
    <updated>2019-05-09T03:11:34.549Z</updated>
    
    <content type="html"><![CDATA[<h1 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h1><img src="/2017/12/12/实现全国自定位天气/1.png" title="exp"> <br><br><br>## 源码 保存html 直接运行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">&lt;meta content=&quot;width=device-width, initial-scale=1, minimum-scale=1.0, maximum-scale=1.0,user-scalable=no&quot; name=&quot;viewport&quot; /&gt;</span><br><span class="line">    &lt;title&gt;&lt;/title&gt;</span><br><span class="line">    &lt;link rel=&quot;stylesheet&quot; href=&quot;&quot;&gt;</span><br><span class="line">    &lt;script type=&quot;text/javascript&quot; src=&quot;./js/jquery-1.10.1.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script type=&quot;text/javascript&quot; src=&quot;./js/util.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">    body&#123;</span><br><span class="line">    width:100%;height:1.75rem;background-color:#2b9ced;</span><br><span class="line">    &#125;</span><br><span class="line">    *&#123;</span><br><span class="line">padding: 0;</span><br><span class="line">margin: 0;</span><br><span class="line">&#125;</span><br><span class="line">    .main&#123;width:100%;height:1.75rem;background-color:#2b9ced;&#125;</span><br><span class="line">    </span><br><span class="line">    img&#123;</span><br><span class="line">    width: 1.3rem;</span><br><span class="line">    height: 1.3rem;</span><br><span class="line">    margin: 0.25rem 0rem 0 0.5rem;</span><br><span class="line">    &#125;</span><br><span class="line">    .show&#123;</span><br><span class="line">    width:3.5rem;</span><br><span class="line">    height: 1.3rem;</span><br><span class="line">    margin-left:1.5rem;</span><br><span class="line">    color:#fff;</span><br><span class="line">    margin-top: -1.7rem;</span><br><span class="line">    font-size: 0.5rem;</span><br><span class="line">    &#125;</span><br><span class="line">    #city,#warm&#123;</span><br><span class="line">    margin-left:0.4rem;</span><br><span class="line">    &#125;</span><br><span class="line">    @media (max-width:320px)&#123;</span><br><span class="line">.show&#123;</span><br><span class="line">font-size: 0.4rem!important;</span><br><span class="line">margin-top: -1.85rem!important;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div class=&quot;main&quot;&gt;</span><br><span class="line">   &lt;p&gt;&lt;img id=&quot;imgs&quot; src=&quot;&quot;/&gt;  &lt;/p&gt;</span><br><span class="line">     &lt;div class=&quot;show&quot;&gt;</span><br><span class="line">       &lt;span id=&quot;city&quot;&gt;&lt;/span&gt;</span><br><span class="line">       &lt;span id=&quot;warm&quot;&gt;&lt;/span&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;div id=&quot;allmap&quot;&gt;&lt;/div&gt;</span><br><span class="line"> &lt;script type=&quot;text/javascript&quot; src=&quot;http://api.map.baidu.com/api?v=2.0&amp;ak=DD279b2a90afdf0ae7a3796787a0742e&quot;&gt;&lt;/script&gt;</span><br><span class="line"> &lt;script&gt;</span><br><span class="line">  var dataList = [</span><br><span class="line">        &#123;</span><br><span class="line">             &quot;img&quot;: &quot;./wea_img/qing.png&quot;,</span><br><span class="line">            &quot;weather&quot;: &quot;晴&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">             &quot;img&quot;: &quot;./wea_img/duoyun.png&quot;,</span><br><span class="line">            &quot;weather&quot;: &quot;多云&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;img&quot;: &quot;./wea_img/yin.png&quot;,</span><br><span class="line">            &quot;weather&quot;: &quot;阴&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;img&quot;: &quot;./wea_img/zhenyu.png&quot;,</span><br><span class="line">            &quot;weather&quot;: &quot;阵雨&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;img&quot;: &quot;./wea_img/leizhenyu.png&quot;,</span><br><span class="line">            &quot;weather&quot;: &quot;雷阵雨&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;img&quot;: &quot;./wea_img/leizhenyubingbao.png&quot;,</span><br><span class="line">            &quot;weather&quot;: &quot;雷阵雨伴有冰雹&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">             &quot;img&quot;: &quot;./wea_img/xiaoxue.png&quot;,</span><br><span class="line">            &quot;weather&quot;: &quot;雨夹雪&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;img&quot;: &quot;./wea_img/xiaoyu.png&quot;,</span><br><span class="line">            &quot;weather&quot;: &quot;小雨&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">           &quot;img&quot;: &quot;./wea_img/zhongyu.png&quot;,</span><br><span class="line">            &quot;weather&quot;: &quot;中雨&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;img&quot;: &quot;./wea_img/dayu.png&quot;,</span><br><span class="line">            &quot;weather&quot;: &quot;大雨&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;img&quot;: &quot;./wea_img/baoyu.png&quot;,</span><br><span class="line">            &quot;weather&quot;: &quot;暴雨&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;img&quot;: &quot;./wea_img/dabaoyu.png&quot;,</span><br><span class="line">            &quot;weather&quot;: &quot;大暴雨&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">             &quot;img&quot;: &quot;./wea_img/tedabaoyu.png&quot;,</span><br><span class="line">            &quot;weather&quot;: &quot;特大暴雨&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">             &quot;img&quot;: &quot;./wea_img/zhenxue.png&quot;,</span><br><span class="line">            &quot;weather&quot;: &quot;阵雪&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;img&quot;: &quot;./wea_img/xiaoxue.png&quot;,</span><br><span class="line">            &quot;weather&quot;: &quot;小雪&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">             &quot;img&quot;: &quot;./wea_img/zhongxue.png&quot;,</span><br><span class="line">            &quot;weather&quot;: &quot;中雪&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">             &quot;img&quot;: &quot;./wea_img/daxue.png&quot;,</span><br><span class="line">            &quot;weather&quot;: &quot;大雪&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;img&quot;: &quot;./wea_img/baoxue.png&quot;,</span><br><span class="line">            &quot;weather&quot;: &quot;暴雪&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;img&quot;: &quot;./wea_img/wu.png&quot;,</span><br><span class="line">            &quot;weather&quot;: &quot;雾&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          &quot;img&quot;: &quot;./wea_img/dongyu.png&quot;,</span><br><span class="line">            &quot;weather&quot;: &quot;冻雨&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;img&quot;: &quot;./wea_img/shachenbao.png&quot;,</span><br><span class="line">            &quot;weather&quot;: &quot;沙尘暴&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;img&quot;: &quot;./wea_img/fuchen.png&quot;,</span><br><span class="line">             &quot;weather&quot;: &quot;浮尘&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">           &quot;img&quot;: &quot;./wea_img/yangsha.png&quot;,</span><br><span class="line">            &quot;weather&quot;: &quot;扬沙&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">              &quot;img&quot;: &quot;./wea_img/qiangshachenbao.png&quot;,</span><br><span class="line">            &quot;weather&quot;: &quot;强沙尘暴&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">             &quot;img&quot;: &quot;./wea_img/mai.png&quot;,</span><br><span class="line">            &quot;weather&quot;: &quot;霾&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    ];</span><br><span class="line">     </span><br><span class="line">       //获取位置</span><br><span class="line">    function getLocation()&#123;</span><br><span class="line">        if (navigator.geolocation)&#123;</span><br><span class="line">            navigator.geolocation.getCurrentPosition(showPosition);</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            alert(&apos;不支持获取位置&apos;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    //显示地图</span><br><span class="line">    function showPosition(position)&#123;</span><br><span class="line">       // 百度地图API功能</span><br><span class="line">        var map = new BMap.Map(&quot;allmap&quot;);</span><br><span class="line">        var point = new BMap.Point(position.coords.longitude,position.coords.latitude);</span><br><span class="line">        map.centerAndZoom(point,12);</span><br><span class="line">        var myCity = new BMap.LocalCity();</span><br><span class="line">        myCity.get(myFun);</span><br><span class="line">    &#125;</span><br><span class="line">     //获取市</span><br><span class="line">    function myFun(result)&#123;</span><br><span class="line">        var city = result.name; </span><br><span class="line">        if(city &amp;&amp; city.indexOf(&apos;市&apos;) !=-1)&#123;</span><br><span class="line">           city = city.replace(/市/, &quot;&quot;);</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            city =&quot;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        alert(&apos;city:&apos;+city);</span><br><span class="line">      getWea(city);</span><br><span class="line">   </span><br><span class="line">     &#125;</span><br><span class="line">    </span><br><span class="line">    function getWea(cityName)&#123;</span><br><span class="line">          //新浪接口  city=城市或者缩写，不输入自动识别城市</span><br><span class="line">            $.getScript(&apos;http://php.weather.sina.com.cn/iframe/index/w_cl.php?code=js&amp;day=0&amp;city=&apos;+ cityName+&apos;&amp;dfc=1&amp;charset=utf-8&apos;,function(a)&#123;</span><br><span class="line">            var s=&quot;&quot;,r=&quot;&quot;,q=&quot;&quot;;</span><br><span class="line">            for(s in window.SWther.w)&#123;</span><br><span class="line">                q=SWther.w[s][0];</span><br><span class="line">                r=&#123;city:s,date:SWther.add.now.split(&quot; &quot;)[0]||&quot;&quot;,day_weather:q.s1,night_weather:q.s2,day_temp:q.t1,night_temp:q.t2,day_wind:q.p1,night_wind:q.p2&#125;;</span><br><span class="line">                console.log(r);</span><br><span class="line">            var default_tr=false;</span><br><span class="line">                var default_img=&apos;./wea_img/default.png&apos;;</span><br><span class="line">                    if(q.s1.indexOf(&apos;到&apos;) !=-1 &amp;&amp; q.s1.indexOf(&apos;转&apos;) !=-1 )&#123;  //有转有到 取转</span><br><span class="line">                        var wea_one =q.s1.split(&apos;转&apos;); </span><br><span class="line">                            q.s1 =wea_one[1]; </span><br><span class="line">                            console.log(&quot;转：&quot;+q.s1);    </span><br><span class="line">                &#125;else&#123;</span><br><span class="line">                    if(q.s1.indexOf(&apos;到&apos;) !=-1 || q.s1.indexOf(&apos;转&apos;) !=-1 )&#123; </span><br><span class="line">                                if(q.s1.indexOf(&apos;到&apos;) !=-1)&#123;  </span><br><span class="line">                                        var wea_one =q.s1.split(&apos;到&apos;); </span><br><span class="line">                                        q.s1 =wea_one[1]; </span><br><span class="line">                                        console.log(&quot;到：&quot;+q.s1);</span><br><span class="line">                                &#125;else&#123;</span><br><span class="line">                                    var wea_one =q.s1.split(&apos;转&apos;); </span><br><span class="line">                                        q.s1 =wea_one[1]; </span><br><span class="line">                                        console.log(&quot;转：&quot;+q.s1);</span><br><span class="line">                                &#125;</span><br><span class="line">                                </span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            </span><br><span class="line">                //匹配</span><br><span class="line">                for(var i=0; i&lt;dataList.length;i++)&#123;</span><br><span class="line">                    if(dataList[i].weather.indexOf(q.s1) !=-1)&#123;</span><br><span class="line">                        console.log(dataList[i].weather);</span><br><span class="line">                        var img_url =dataList[i].img;</span><br><span class="line">                        $(&apos;#imgs&apos;).attr(&apos;src&apos;,img_url);</span><br><span class="line">                        default_tr =true ;</span><br><span class="line">                        break;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                //没有匹配</span><br><span class="line">                if(!default_tr)&#123;</span><br><span class="line">                $(&apos;#imgs&apos;).attr(&apos;src&apos;,default_img);</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                //温度</span><br><span class="line">                var warm_html =&quot;&quot;;</span><br><span class="line">                if(r.day_temp&gt;r.night_temp)&#123;</span><br><span class="line">                    warm_html = r.night_temp+&quot;~&quot;+ r.day_temp;</span><br><span class="line">                &#125;else&#123;</span><br><span class="line">                    warm_html = r.day_temp+&quot;~&quot;+ r.night_temp;</span><br><span class="line">                &#125;</span><br><span class="line">                $(&quot;#city&quot;).html(r.city);</span><br><span class="line">                $(&quot;#warm&quot;).html(warm_html+&quot;℃&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    getLocation();</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;示例&quot;&gt;&lt;a href=&quot;#示例&quot; class=&quot;headerlink&quot; title=&quot;示例&quot;&gt;&lt;/a&gt;示例&lt;/h1&gt;&lt;img src=&quot;/2017/12/12/实现全国自定位天气/1.png&quot; title=&quot;exp&quot;&gt; &lt;br&gt;&lt;br&gt;&lt;br&gt;## 源码 保存h
      
    
    </summary>
    
    
      <category term="html js" scheme="http://note.yidianwz.com/tags/html-js/"/>
    
  </entry>
  
  <entry>
    <title>微信公众号支付 jsapi支付</title>
    <link href="http://note.yidianwz.com/2017/11/15/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E6%94%AF%E4%BB%98-jsapi%E6%94%AF%E4%BB%98/"/>
    <id>http://note.yidianwz.com/2017/11/15/微信公众号支付-jsapi支付/</id>
    <published>2017-11-15T03:33:33.000Z</published>
    <updated>2019-05-09T03:11:34.556Z</updated>
    
    <content type="html"><![CDATA[<h3 id="官方文档"><a href="#官方文档" class="headerlink" title="官方文档"></a>官方文档</h3><p>  <a href="https://pay.weixin.qq.com/wiki/doc/api/jsapi.php?chapter=7_3" target="_blank" rel="noopener">https://pay.weixin.qq.com/wiki/doc/api/jsapi.php?chapter=7_3</a></p><h3 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h3><ul><li><p>公众号添加白名单<br><a href="https://mp.weixin.qq.com/cgi-bin/announce?action=getannouncement&amp;key=1495617578&amp;version=1&amp;lang=zh_CN&amp;platform=2&amp;token=755171451" target="_blank" rel="noopener">https://mp.weixin.qq.com/cgi-bin/announce?action=getannouncement&amp;key=1495617578&amp;version=1&amp;lang=zh_CN&amp;platform=2&amp;token=755171451</a></p></li><li><p>商户号与公众号绑定<br><a href="https://pay.weixin.qq.com/static/pay_setting/appid_protocol.shtml" target="_blank" rel="noopener">https://pay.weixin.qq.com/static/pay_setting/appid_protocol.shtml</a> </p></li><li><p>完整步骤资料<br><a href="https://blog.csdn.net/javaYouCome/article/details/79473743" target="_blank" rel="noopener">https://blog.csdn.net/javaYouCome/article/details/79473743</a> </p></li></ul><h2 id="所有资料（缺一不可）"><a href="#所有资料（缺一不可）" class="headerlink" title="所有资料（缺一不可）"></a>所有资料（缺一不可）</h2><ul><li>需要资料 ： </li><li>商户号（mch_id）</li><li>商户秘钥：（partner_key）</li><li>商户号证书： 公钥 &amp; 私钥</li></ul><hr><ul><li>公众号id：（app_id）</li><li>公众号秘钥 APPSECEPT </li></ul><hr><ul><li>公众号支付目录设置  </li><li>网页授权域名 设置  </li><li>js网页授权</li><li>授权验证文件（.txt文件）</li></ul><hr><p>##常见问题</p><ul><li>前端 wx.config 配置失败；根据失败提示进行配置，<br>一般是 token过期， url配置错误 （js，授权目录）</li><li>分清楚 基础token 和 web_token 的区别</li></ul><hr><h2 id="开发示例"><a href="#开发示例" class="headerlink" title="开发示例"></a>开发示例</h2><h3 id="1-如果采用weixin-pay-npm-包，注意："><a href="#1-如果采用weixin-pay-npm-包，注意：" class="headerlink" title="1.如果采用weixin-pay npm 包，注意："></a>1.如果采用weixin-pay npm 包，注意：</h3><p>当 返回结果 prepay_id, 统一下单错误</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var reqparam = &#123;</span><br><span class="line">appId: _this.options.appid,</span><br><span class="line">timeStamp: Math.floor(Date.now()/1000)+&quot;&quot;,</span><br><span class="line">nonceStr: data.nonce_str,</span><br><span class="line">package: &quot;prepay_id=underfind,(这里)</span><br><span class="line">signType: &quot;MD5&quot;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><img src="/2017/11/15/微信公众号支付-jsapi支付/err.jpg" title="weixin-pay代码"> <br><br><br>### 2.前端示例代码<br>- 配置weixin-js 代码<br><img src="/2017/11/15/微信公众号支付-jsapi支付/config.png" title="config代码"> <br><br><br>- pay 代码<br><img src="/2017/11/15/微信公众号支付-jsapi支付/pay.png" title="config代码"> <br><br><br>### 统一下单<br>- 官方文档<br> <a href="https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1421141115" target="_blank" rel="noopener">https://mp.weixin.qq.com/wiki?t=resource/res_main&amp;id=mp1421141115</a><br>- 异步回调通知<br> <a href="https://pay.weixin.qq.com/wiki/doc/api/jsapi.php?chapter=9_7&amp;index=8" target="_blank" rel="noopener">https://pay.weixin.qq.com/wiki/doc/api/jsapi.php?chapter=9_7&amp;index=8</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">回调参数xml数据解析后示例：</span><br><span class="line">&#123;&quot;appid&quot;:[&quot;wx230378b441a84e1b1&quot;],</span><br><span class="line">     &quot;bank_type&quot;:[&quot;CFT&quot;],</span><br><span class="line">     &quot;cash_fee&quot;:[&quot;1&quot;],</span><br><span class="line">     &quot;fee_type&quot;:[&quot;CNY&quot;],</span><br><span class="line">     &quot;is_subscribe&quot;:[&quot;Y&quot;],</span><br><span class="line">     &quot;mch_id&quot;:[&quot;15108183471&quot;],</span><br><span class="line">     &quot;nonce_str&quot;:[&quot;pyY7PLJ5BF9xK6yTH9QUjI2jtUohDtLb&quot;],</span><br><span class="line">     &quot;openid&quot;:[&quot;odv3i0-qsinD4dMv7j-bSQQGo1Fs&quot;],</span><br><span class="line">     &quot;out_trade_no&quot;:[&quot;2019031811118531552879185506&quot;],</span><br><span class="line">     &quot;result_code&quot;:[&quot;SUCCESS&quot;],</span><br><span class="line">     &quot;return_code&quot;:[&quot;SUCCESS&quot;],</span><br><span class="line">     &quot;sign&quot;:[&quot;79A0A73CF6E98414B4FCA0A1BEC5B2640&quot;],</span><br><span class="line">     &quot;time_end&quot;:[&quot;201903181111817&quot;],</span><br><span class="line">     &quot;total_fee&quot;:[&quot;1&quot;],</span><br><span class="line">     &quot;trade_type&quot;:[&quot;JSAPI&quot;],</span><br><span class="line">     &quot;transaction_id&quot;:[&quot;42000010256201903184142657168&quot;]&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;官方文档&quot;&gt;&lt;a href=&quot;#官方文档&quot; class=&quot;headerlink&quot; title=&quot;官方文档&quot;&gt;&lt;/a&gt;官方文档&lt;/h3&gt;&lt;p&gt;  &lt;a href=&quot;https://pay.weixin.qq.com/wiki/doc/api/jsapi.php?ch
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>node 封装支付宝支付公用 api，包含支付 查询 退款等</title>
    <link href="http://note.yidianwz.com/2017/11/12/node-%E5%B0%81%E8%A3%85%E6%94%AF%E4%BB%98%E5%AE%9D%E6%94%AF%E4%BB%98api/"/>
    <id>http://note.yidianwz.com/2017/11/12/node-封装支付宝支付api/</id>
    <published>2017-11-12T03:22:42.000Z</published>
    <updated>2019-05-09T03:11:34.408Z</updated>
    
    <content type="html"><![CDATA[<h1 id="alipay-chatyu-v1-0-1"><a href="#alipay-chatyu-v1-0-1" class="headerlink" title="alipay-chatyu - v1.0.1"></a>alipay-chatyu - v1.0.1</h1><h2 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h2><ul><li>Using npm:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm insatll alipay-chatyu -s</span><br></pre></td></tr></table></figure></li></ul><h2 id="alipay-api-支付宝支付api"><a href="#alipay-api-支付宝支付api" class="headerlink" title="alipay_api:支付宝支付api"></a>alipay_api:<a href="https://doc.open.alipay.com/doc2/apiList?docType=4" title="alipay文档" target="_blank" rel="noopener">支付宝支付api</a></h2><h3 id="In-Node-js"><a href="#In-Node-js" class="headerlink" title="In Node.js: "></a>In Node.js: <br></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">const AlipayAPI = require(&apos;alipay-chatyu&apos;);</span><br><span class="line">const Fiber = require(&apos;fibers&apos;); // Asynchronous to synchronous  </span><br><span class="line"></span><br><span class="line">var ali_conf = &#123;&#125;; //ali_config</span><br><span class="line">    ali_conf.app_id = &quot;xxxxxxx&quot;; //app_id</span><br><span class="line">    ali_conf.public_key_name = &quot;open_rsa_public_key.pem&quot;;//public_key name</span><br><span class="line">    ali_conf.private_key_name = &quot;open_rsa_private_key.pem&quot;;//private_key name</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//exp： alipay.trade.precreate </span><br><span class="line"></span><br><span class="line">Fiber(function() &#123;</span><br><span class="line">   var data = &#123;&#125;;</span><br><span class="line"> data.subject = &apos;shop_name&apos;; //title</span><br><span class="line"> data.out_trade_no =&quot;001&quot;+(new Date()).valueOf(); //out_trade_no</span><br><span class="line"> data.total_amount = 1.00; //price</span><br><span class="line"> data.body =&apos;shop_disc&apos;;//disc</span><br><span class="line">   </span><br><span class="line"> var result =[];</span><br><span class="line"> try&#123; </span><br><span class="line">     result = AlipayAPI.request(ali_conf,&apos;alipay.trade.precreate&apos;,data); //aliapi func_name </span><br><span class="line">     if(result.status=&apos;成功&apos;)&#123;</span><br><span class="line">      console.log(result);</span><br><span class="line">     &#125;else&#123;</span><br><span class="line">         console.log(result.status);</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;catch(err)&#123;</span><br><span class="line">    console.log(err);</span><br><span class="line"> &#125;</span><br><span class="line">    </span><br><span class="line">&#125;).run();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//exp: alipay.trade.query</span><br><span class="line"> Fiber(function() &#123;</span><br><span class="line">  </span><br><span class="line">   var req =&#123;</span><br><span class="line">     &quot;trade_no&quot;:&quot;20170222555&quot;, //trade_no</span><br><span class="line">     &quot;out_trade_no&quot;:&quot;&quot; //out_trade_no  </span><br><span class="line">    &#125;;</span><br><span class="line">    var result =[];</span><br><span class="line"> try&#123;</span><br><span class="line">     result = AlipayAPI.request(ali_conf,&apos;alipay.trade.query&apos;,req);</span><br><span class="line"> &#125;catch(err)&#123;</span><br><span class="line">    console.log(err);</span><br><span class="line"> &#125;</span><br><span class="line">  </span><br><span class="line">&#125;).run();</span><br><span class="line"></span><br><span class="line">//exp: alipay.trade.refund </span><br><span class="line"> Fiber(function() &#123;</span><br><span class="line">  </span><br><span class="line">   var big_content=&#123;&#125;;</span><br><span class="line">        big_content.trade_no =f.trade_no;</span><br><span class="line">        big_content.out_trade_no=f.order_id;</span><br><span class="line">        big_content.refund_amount = f.refund_amount;</span><br><span class="line">        big_content.refund_reason = f.explain;</span><br><span class="line">    var result =[];</span><br><span class="line"> try&#123;</span><br><span class="line">     result =AlipayAPI.request(ali_conf,ali_conf.method,big_content);</span><br><span class="line"> &#125;catch(err)&#123;</span><br><span class="line">    console.log(err);</span><br><span class="line"> &#125;</span><br><span class="line">  </span><br><span class="line">&#125;).run();</span><br></pre></td></tr></table></figure><h1 id="Attention"><a href="#Attention" class="headerlink" title="Attention"></a>Attention<br></h1><p>-.项目文件名下必须创建config文件，包含内容 为公钥和私钥文件.    </p><p>-project<ul></ul></p><p><li>config<br>   <ul><br>    <li>open_rsa_public_key.pem</li><br>    <li>open_rsa_private_key.pem</li><br>   </ul></li></p><p><li><br></li></p><h3 id="图例："><a href="#图例：" class="headerlink" title="图例："></a>图例：</h3><p>  <img src="/2017/11/12/node-封装支付宝支付api/expali.png" title="exp"> <br></p><h2 id="Support"><a href="#Support" class="headerlink" title="Support"></a>Support</h2><p>Tested in  Node.js 6-7, &amp; PhantomJS 2.1.1.<br></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;alipay-chatyu-v1-0-1&quot;&gt;&lt;a href=&quot;#alipay-chatyu-v1-0-1&quot; class=&quot;headerlink&quot; title=&quot;alipay-chatyu - v1.0.1&quot;&gt;&lt;/a&gt;alipay-chatyu - v1.0.1&lt;/
      
    
    </summary>
    
    
      <category term="node alipay-chatyu" scheme="http://note.yidianwz.com/tags/node-alipay-chatyu/"/>
    
  </entry>
  
  <entry>
    <title>javascript 输入框常用限制和正则</title>
    <link href="http://note.yidianwz.com/2017/11/11/javascript-%E8%BE%93%E5%85%A5%E6%A1%86%E5%B8%B8%E7%94%A8%E9%99%90%E5%88%B6%E5%92%8C%E6%AD%A3%E5%88%99/"/>
    <id>http://note.yidianwz.com/2017/11/11/javascript-输入框常用限制和正则/</id>
    <published>2017-11-11T07:34:28.000Z</published>
    <updated>2019-05-09T03:11:34.388Z</updated>
    
    <content type="html"><![CDATA[<h3 id="有时需要限制文本框输入内容的类型，本节分享下正则表达式限制文本框只能输入数字、小数点、英文字母、汉字等代码。"><a href="#有时需要限制文本框输入内容的类型，本节分享下正则表达式限制文本框只能输入数字、小数点、英文字母、汉字等代码。" class="headerlink" title="有时需要限制文本框输入内容的类型，本节分享下正则表达式限制文本框只能输入数字、小数点、英文字母、汉字等代码。"></a>有时需要限制文本框输入内容的类型，本节分享下正则表达式限制文本框只能输入数字、小数点、英文字母、汉字等代码。</h3><h4 id="例如，输入大于0的正整数"><a href="#例如，输入大于0的正整数" class="headerlink" title="例如，输入大于0的正整数"></a>例如，输入大于0的正整数</h4><p>代码如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input onkeyup=&quot;if(this.value.length==1)&#123;this.value=this.value.replace(/[^1-9]/g,&apos;&apos;)&#125;else&#123;this.value=this.value.replace(/\D/g,&apos;&apos;)&#125;&quot; onafterpaste=&quot;if(this.value.length==1)&#123;this.value=this.value.replace(/[^1-9]/g,&apos;&apos;)&#125;else&#123;this.value=this.value.replace(/\D/g,&apos;&apos;)&#125;&quot;&gt;</span><br></pre></td></tr></table></figure></p><h3 id="文本框只能输入数字代码-小数点也不能输入"><a href="#文本框只能输入数字代码-小数点也不能输入" class="headerlink" title="文本框只能输入数字代码(小数点也不能输入)"></a>文本框只能输入数字代码(小数点也不能输入)</h3><p>代码如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input onkeyup=&quot;this.value=this.value.replace(/\D/g,&apos;&apos;)&quot; onafterpaste=&quot;this.value=this.value.replace(/\D/g,&apos;&apos;)&quot;&gt;</span><br></pre></td></tr></table></figure></p><h3 id="只能输入数字-能输小数点"><a href="#只能输入数字-能输小数点" class="headerlink" title="只能输入数字,能输小数点."></a>只能输入数字,能输小数点.</h3><p>代码如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;input onkeyup=&quot;if(isNaN(value))execCommand(&apos;undo&apos;)&quot; onafterpaste=&quot;if(isNaN(value))execCommand(&apos;undo&apos;)&quot;&gt;</span><br><span class="line">&lt;input name=txt1 onchange=&quot;if(/\D/.test(this.value))&#123;alert(&apos;只能输入数字&apos;);this.value=&apos;&apos;;&#125;&quot;&gt;</span><br></pre></td></tr></table></figure></p><h3 id="数字和小数点方法二"><a href="#数字和小数点方法二" class="headerlink" title="数字和小数点方法二"></a>数字和小数点方法二</h3><p>代码如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=text t_value=&quot;&quot; o_value=&quot;&quot; onkeypress=&quot;if(!this.value.match(/^[\+\-]?\d*?\.?\d*?$/))this.value=this.t_value;else this.t_value=this.value;if(this.value.match(/^(?:[\+\-]?\d+(?:\.\d+)?)?$/))this.o_value=this.value&quot; onkeyup=&quot;if(!this.value.match(/^[\+\-]?\d*?\.?\d*?$/))this.value=this.t_value;else this.t_value=this.value;if(this.value.match(/^(?:[\+\-]?\d+(?:\.\d+)?)?$/))this.o_value=this.value&quot; onblur=&quot;if(!this.value.match(/^(?:[\+\-]?\d+(?:\.\d+)?|\.\d*?)?$/))this.value=this.o_value;else&#123;if(this.value.match(/^\.\d+$/))this.value=0+this.value;if(this.value.match(/^\.$/))this.value=0;this.o_value=this.value&#125;&quot;&gt;</span><br></pre></td></tr></table></figure></p><h3 id="封装成单独的函数："><a href="#封装成单独的函数：" class="headerlink" title="封装成单独的函数："></a>封装成单独的函数：</h3><p>代码如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">function keyPress(ob) &#123;</span><br><span class="line"> if (!ob.value.match(/^[\+\-]?\d*?\.?\d*?$/)) ob.value = ob.t_value; else ob.t_value = ob.value; if (ob.value.match(/^(?:[\+\-]?\d+(?:\.\d+)?)?$/)) ob.o_value = ob.value;</span><br><span class="line">&#125;</span><br><span class="line">function keyUp(ob) &#123;</span><br><span class="line"> if (!ob.value.match(/^[\+\-]?\d*?\.?\d*?$/)) ob.value = ob.t_value; else ob.t_value = ob.value; if (ob.value.match(/^(?:[\+\-]?\d+(?:\.\d+)?)?$/)) ob.o_value = ob.value;</span><br><span class="line">        &#125;</span><br><span class="line">function onBlur(ob) &#123;</span><br><span class="line">if(!ob.value.match(/^(?:[\+\-]?\d+(?:\.\d+)?|\.\d*?)?$/))ob.value=ob.o_value;else&#123;if(ob.value.match(/^\.\d+$/))ob.value=0+ob.value;if(ob.value.match(/^\.$/))ob.value=0;ob.o_value=ob.value&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>–只需在调用，传入this对象即可!</p><h3 id="4，只能输入字母和汉字"><a href="#4，只能输入字母和汉字" class="headerlink" title="4，只能输入字母和汉字"></a>4，只能输入字母和汉字</h3><p>代码如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input onkeyup=&quot;value=value.replace(/[\d]/g,&apos;&apos;) &quot;onbeforepaste=&quot;clipboardData.setData(&apos;text&apos;,clipboardData.getData(&apos;text&apos;).replace(/[\d]/g,&apos;&apos;))&quot; maxlength=10 name=&quot;Numbers&quot;&gt;</span><br></pre></td></tr></table></figure></p><h3 id="5，只能输入英文字母和数字-不能输入中文"><a href="#5，只能输入英文字母和数字-不能输入中文" class="headerlink" title="5，只能输入英文字母和数字,不能输入中文"></a>5，只能输入英文字母和数字,不能输入中文</h3><p> 代码如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input onkeyup=&quot;value=value.replace(/[^\w\.\/]/ig,&apos;&apos;)&quot;&gt;</span><br></pre></td></tr></table></figure></p><h3 id="6，只能输入数字和英文"><a href="#6，只能输入数字和英文" class="headerlink" title="6，只能输入数字和英文"></a>6，只能输入数字和英文</h3><p>代码如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input onKeyUp=&quot;value=value.replace(/[^\d|chun]/g,&apos;&apos;)&quot;&gt;</span><br></pre></td></tr></table></figure></p><h3 id="7，小数点后只能有最多两位-数字-中文都可输入-不能输入字母和运算符号"><a href="#7，小数点后只能有最多两位-数字-中文都可输入-不能输入字母和运算符号" class="headerlink" title="7，小数点后只能有最多两位(数字,中文都可输入),不能输入字母和运算符号:"></a>7，小数点后只能有最多两位(数字,中文都可输入),不能输入字母和运算符号:</h3><p>代码如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input onKeyPress=&quot;if((event.keyCode&lt;48 || event.keyCode&gt;57) &amp;&amp; event.keyCode!=46 || /\.\d\d$/.test(value))event.returnValue=false&quot;&gt;</span><br></pre></td></tr></table></figure></p><h3 id="8，小数点后只能有最多两位-数字-字母-中文都可输入-可以输入运算符号"><a href="#8，小数点后只能有最多两位-数字-字母-中文都可输入-可以输入运算符号" class="headerlink" title="8，小数点后只能有最多两位(数字,字母,中文都可输入),可以输入运算符号:"></a>8，小数点后只能有最多两位(数字,字母,中文都可输入),可以输入运算符号:</h3><p>代码如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input onkeyup=&quot;this.value=this.value.replace(/^(\-)*(\d+)\.(\d\d).*$/,&apos;$1$2.$3&apos;)&quot;&gt;</span><br></pre></td></tr></table></figure></p><h3 id="9、ENTER键可以让光标移到下一个输入框"><a href="#9、ENTER键可以让光标移到下一个输入框" class="headerlink" title="9、ENTER键可以让光标移到下一个输入框"></a>9、ENTER键可以让光标移到下一个输入框</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=&quot;text&quot; onkeydown=&quot;if(event.keyCode==13)event.keyCode=9&quot; /&gt; </span><br><span class="line">``` </span><br><span class="line">### 10、正则匹配</span><br></pre></td></tr></table></figure><p>^[1-9]\d<em>$　 　 //匹配正整数<br>^-[1-9]\d</em>$ 　 //匹配负整数<br>^-?[1-9]\d<em>$　　 //匹配整数<br>^[1-9]\d</em>|0$　 //匹配非负整数（正整数 + 0）<br>^-[1-9]\d<em>|0$　　 //匹配非正整数（负整数 + 0）<br>^[1-9]\d</em>.\d<em>|0.\d</em>[1-9]\d<em>$　　 //匹配正浮点数<br>^-([1-9]\d</em>.\d<em>|0.\d</em>[1-9]\d<em>)$　 //匹配负浮点数<br>^-?([1-9]\d</em>.\d<em>|0.\d</em>[1-9]\d<em>|0?.0+|0)$　 //匹配浮点数<br>^[1-9]\d</em>.\d<em>|0.\d</em>[1-9]\d<em>|0?.0+|0$　　 //匹配非负浮点数（正浮点数 + 0）<br>^(-([1-9]\d</em>.\d<em>|0.\d</em>[1-9]\d*))|0?.0+|0$　　//匹配非正浮点数（负浮点数 + 0）<br><code>`</code></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;有时需要限制文本框输入内容的类型，本节分享下正则表达式限制文本框只能输入数字、小数点、英文字母、汉字等代码。&quot;&gt;&lt;a href=&quot;#有时需要限制文本框输入内容的类型，本节分享下正则表达式限制文本框只能输入数字、小数点、英文字母、汉字等代码。&quot; class=&quot;hea
      
    
    </summary>
    
    
      <category term="javascript" scheme="http://note.yidianwz.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>vue2.打包兼容360和IE浏览器</title>
    <link href="http://note.yidianwz.com/2017/10/28/vue2-%E6%89%93%E5%8C%85%E5%85%BC%E5%AE%B9360%E5%92%8CIE%E6%B5%8F%E8%A7%88%E5%99%A8/"/>
    <id>http://note.yidianwz.com/2017/10/28/vue2-打包兼容360和IE浏览器/</id>
    <published>2017-10-28T02:18:22.000Z</published>
    <updated>2019-05-09T03:11:34.452Z</updated>
    
    <content type="html"><![CDATA[<h4 id="360-页面空白，并报错此页上的代码禁用了反向和正向缓存"><a href="#360-页面空白，并报错此页上的代码禁用了反向和正向缓存" class="headerlink" title="360 页面空白，并报错此页上的代码禁用了反向和正向缓存"></a>360 页面空白，并报错此页上的代码禁用了反向和正向缓存</h4><h2 id="Vue2-Webpack-ES6-兼容低版本浏览器（IE9）解决方案"><a href="#Vue2-Webpack-ES6-兼容低版本浏览器（IE9）解决方案" class="headerlink" title="Vue2+Webpack+ES6 兼容低版本浏览器（IE9）解决方案"></a>Vue2+Webpack+ES6 兼容低版本浏览器（IE9）解决方案</h2><ul><li><p>解决方式：安装 “babel-polyfill” 即可。命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev babel-polyfill</span><br></pre></td></tr></table></figure></li><li><p>在入口main.js文件引入：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import &apos;babel-polyfill&apos;</span><br></pre></td></tr></table></figure></li><li><p>最后一步，在build文件夹下找到webpack.base.conf.js.</p></li><li><p>修改入口方式：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">entry: &#123;app: [&quot;babel-polyfill&quot;, &quot;./src/main.js&quot;]&#125;</span><br></pre></td></tr></table></figure></li><li><p>最后，再依赖一个插件解决ES6/ES7高级语法兼容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev babel-preset-es2015-ie</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h4 id=&quot;360-页面空白，并报错此页上的代码禁用了反向和正向缓存&quot;&gt;&lt;a href=&quot;#360-页面空白，并报错此页上的代码禁用了反向和正向缓存&quot; class=&quot;headerlink&quot; title=&quot;360 页面空白，并报错此页上的代码禁用了反向和正向缓存&quot;&gt;&lt;/a&gt;36
      
    
    </summary>
    
    
      <category term="vue webpack" scheme="http://note.yidianwz.com/tags/vue-webpack/"/>
    
  </entry>
  
  <entry>
    <title>redis按照和自启动服务</title>
    <link href="http://note.yidianwz.com/2017/10/10/redis%E6%8C%89%E7%85%A7%E5%92%8C%E8%87%AA%E5%90%AF%E5%8A%A8%E6%9C%8D%E5%8A%A1/"/>
    <id>http://note.yidianwz.com/2017/10/10/redis按照和自启动服务/</id>
    <published>2017-10-10T07:01:47.000Z</published>
    <updated>2019-05-09T03:11:34.439Z</updated>
    
    <content type="html"><![CDATA[<h1 id="centos7-2-安装redis，并设置成服务，开机自启"><a href="#centos7-2-安装redis，并设置成服务，开机自启" class="headerlink" title="centos7.2 安装redis，并设置成服务，开机自启"></a>centos7.2 安装redis，并设置成服务，开机自启</h1><h3 id="1-在-usr-local-底下，放redis安装包："><a href="#1-在-usr-local-底下，放redis安装包：" class="headerlink" title="1.在/usr/local/底下，放redis安装包："></a>1.在/usr/local/底下，放redis安装包：</h3><p>  redis-4.0.1.tar.gz</p><h3 id="或者解压安装："><a href="#或者解压安装：" class="headerlink" title="或者解压安装："></a>或者解压安装：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">wget http://download.redis.io/releases/redis-4.0.1.tar.gz</span><br><span class="line"></span><br><span class="line">tar zxvf redis-4.0.1.tar.gz</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cd  /usr/local</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure><h3 id="3-建立redis文件夹：并将redis-conf配置文件拷贝到redis下"><a href="#3-建立redis文件夹：并将redis-conf配置文件拷贝到redis下" class="headerlink" title="3.建立redis文件夹：并将redis.conf配置文件拷贝到redis下"></a>3.建立redis文件夹：并将redis.conf配置文件拷贝到redis下</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir /etc/redis </span><br><span class="line"></span><br><span class="line">cp /usr/local/redis-4.0.1/redis.conf /etc/redis/6379.conf</span><br></pre></td></tr></table></figure><h3 id="4-将启动脚本复制到-etc-init-d目录下-并取名为redis"><a href="#4-将启动脚本复制到-etc-init-d目录下-并取名为redis" class="headerlink" title="4.将启动脚本复制到/etc/init.d目录下,并取名为redis"></a>4.将启动脚本复制到/etc/init.d目录下,并取名为redis</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp /usr/local/redis-4.0.1/utils/redis_init_script /etc/init.d/redis</span><br></pre></td></tr></table></figure><h3 id="5-设置开机启动，在redis-init-script脚本中开头增加以下内容："><a href="#5-设置开机启动，在redis-init-script脚本中开头增加以下内容：" class="headerlink" title="5.设置开机启动，在redis_init_script脚本中开头增加以下内容："></a>5.设置开机启动，在redis_init_script脚本中开头增加以下内容：</h3><h3 id="创建redisd服务：-vi-etc-init-d-redis"><a href="#创建redisd服务：-vi-etc-init-d-redis" class="headerlink" title="创建redisd服务： vi /etc/init.d/redis"></a>创建redisd服务： vi /etc/init.d/redis</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#chkconfig: 2345 90 10</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">在脚本中start)的 $EXEC $CONF后面加上：&amp;</span><br><span class="line"></span><br><span class="line">$CLIEXEC -a &quot;123456&quot; -p $REDISPORT shutdown</span><br></pre></td></tr></table></figure><h3 id="6-设置访问连接权限和后台启动："><a href="#6-设置访问连接权限和后台启动：" class="headerlink" title="6.设置访问连接权限和后台启动："></a>6.设置访问连接权限和后台启动：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/redis/6379.conf</span><br><span class="line"></span><br><span class="line">55行 bind 121.201.67.222 192.168.0.218 (外网地址    内网 ipconfig)</span><br><span class="line"></span><br><span class="line">56行 # bind 127.0.0.1 ::1</span><br><span class="line"></span><br><span class="line">69行 加上本机地址 （内网）</span><br><span class="line"></span><br><span class="line">136行  daemonize yes</span><br><span class="line"></span><br><span class="line">500行   设置密码：requirepass 你的密码</span><br><span class="line"></span><br><span class="line">532行    设置最大连接数：  maxclients</span><br></pre></td></tr></table></figure><h3 id="7-防火墙开启端口："><a href="#7-防火墙开启端口：" class="headerlink" title="7.防火墙开启端口："></a>7.防火墙开启端口：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --zone=public --add-port=6379/tcp --permanent</span><br><span class="line"></span><br><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure><h3 id="8-设置开机启动："><a href="#8-设置开机启动：" class="headerlink" title="8.设置开机启动："></a>8.设置开机启动：</h3><p>chkconfig redis on</p><p>9.启动，关闭，重启 服务：</p><p>systemctl start redis</p><p>systemctl restart redis</p><p>systemctl stop redis</p><p>systemctl daemon-reload 加载</p><hr><p>客户端连接：<br>redis-cli.exe -h <strong><em>.</em></strong>.<strong><em>.</em></strong> -p 6379<br>AUTH 密码<br>set 内容   名称<br>get  名称</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;centos7-2-安装redis，并设置成服务，开机自启&quot;&gt;&lt;a href=&quot;#centos7-2-安装redis，并设置成服务，开机自启&quot; class=&quot;headerlink&quot; title=&quot;centos7.2 安装redis，并设置成服务，开机自启&quot;&gt;&lt;/a
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>node封装公用打印文件日志 npm 包</title>
    <link href="http://note.yidianwz.com/2017/10/09/node%E5%B0%81%E8%A3%85%E6%97%A5%E5%BF%97npm%E5%8C%85/"/>
    <id>http://note.yidianwz.com/2017/10/09/node封装日志npm包/</id>
    <published>2017-10-09T03:18:28.000Z</published>
    <updated>2019-05-09T03:11:34.415Z</updated>
    
    <content type="html"><![CDATA[<h1 id="logs-dir"><a href="#logs-dir" class="headerlink" title="logs-dir"></a>logs-dir</h1><h2 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h2><p>Using npm:<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> npm insatll logs-dir -s</span></span><br></pre></td></tr></table></figure></p><p>In Node.js:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> logs = <span class="built_in">require</span>(<span class="string">'logs-dir'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> err_data = <span class="string">"发生错误"</span>;<span class="comment">//error log</span></span><br><span class="line"></span><br><span class="line">logs.write(<span class="string">'error'</span>,err_data);  <span class="comment">//err_data / string  </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> err_list =&#123;<span class="string">"test"</span>:<span class="string">"test1"</span>&#125;; <span class="comment">//error log</span></span><br><span class="line"></span><br><span class="line">logs.write(<span class="string">'error'</span>,<span class="built_in">JSON</span>.stringify(err_list));  <span class="comment">//err_data / object</span></span><br></pre></td></tr></table></figure></p><h2 id="result-created-file"><a href="#result-created-file" class="headerlink" title="result:created file"></a>result:created file<br></h2><ul><li>/_logs/error/2018-08-21.txt <br><h3 id="error-content"><a href="#error-content" class="headerlink" title="error_content:"></a>error_content:<br></h3></li><li><p>–2017-8-21 11:6:32【发生错误】<br></p></li><li><p>–2017-8-21 11:6:32【{“test”:”test1”}】<br></p></li></ul><h2 id="exp"><a href="#exp" class="headerlink" title="exp "></a>exp <br></h2><p><img src="/2017/10/09/node封装日志npm包/exp.png" title="exp"> <br></p><h2 id="Support"><a href="#Support" class="headerlink" title="Support"></a>Support</h2><p>Tested in Chrome 54-55, Firefox 49-50, IE 11, Edge 14, Safari 9-10, Node.js 6-7, &amp; PhantomJS 2.1.1.<br></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;logs-dir&quot;&gt;&lt;a href=&quot;#logs-dir&quot; class=&quot;headerlink&quot; title=&quot;logs-dir&quot;&gt;&lt;/a&gt;logs-dir&lt;/h1&gt;&lt;h2 id=&quot;Installation&quot;&gt;&lt;a href=&quot;#Installation&quot; cla
      
    
    </summary>
    
    
      <category term="node npm" scheme="http://note.yidianwz.com/tags/node-npm/"/>
    
  </entry>
  
  <entry>
    <title>node egg 企业后台开发框架</title>
    <link href="http://note.yidianwz.com/2017/10/09/node-egg%E5%90%8E%E5%8F%B0%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA%E5%AE%9E%E7%8E%B0/"/>
    <id>http://note.yidianwz.com/2017/10/09/node-egg后台项目搭建实现/</id>
    <published>2017-10-09T03:03:29.000Z</published>
    <updated>2019-05-09T03:11:34.402Z</updated>
    
    <content type="html"><![CDATA[<h1 id="egg-demo-搭建"><a href="#egg-demo-搭建" class="headerlink" title="egg-demo 搭建"></a>egg-demo 搭建</h1><h4 id="实现功能"><a href="#实现功能" class="headerlink" title="实现功能"></a>实现功能</h4><ul><li>数据连接封装</li><li>service 类封装</li><li>路由封装</li><li>前后端交互 ejs模板实现</li><li><p>订单业务实现</p></li><li><p><a href="https://github.com/AntonySufer/egg-node" target="_blank" rel="noopener">github地址</a></p></li></ul><h2 id="QuickStart"><a href="#QuickStart" class="headerlink" title="QuickStart"></a>QuickStart</h2><!-- add docs here for user --><p>see <a href="https://eggjs.org" target="_blank" rel="noopener">egg docs</a> for more detail.</p><h3 id="Development"><a href="#Development" class="headerlink" title="Development"></a>Development</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ npm i</span><br><span class="line">$ npm run dev</span><br><span class="line">$ open http://localhost:7001/</span><br></pre></td></tr></table></figure><h3 id="Deploy"><a href="#Deploy" class="headerlink" title="Deploy"></a>Deploy</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ npm start</span><br><span class="line">$ npm stop</span><br></pre></td></tr></table></figure><h3 id="npm-scripts"><a href="#npm-scripts" class="headerlink" title="npm scripts"></a>npm scripts</h3><ul><li>Use <code>npm run lint</code> to check code style.</li><li>Use <code>npm test</code> to run unit test.</li><li>Use <code>npm run autod</code> to auto detect dependencies upgrade, see <a href="https://www.npmjs.com/package/autod" target="_blank" rel="noopener">autod</a> for more detail.</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;egg-demo-搭建&quot;&gt;&lt;a href=&quot;#egg-demo-搭建&quot; class=&quot;headerlink&quot; title=&quot;egg-demo 搭建&quot;&gt;&lt;/a&gt;egg-demo 搭建&lt;/h1&gt;&lt;h4 id=&quot;实现功能&quot;&gt;&lt;a href=&quot;#实现功能&quot; class=&quot;
      
    
    </summary>
    
    
      <category term="node egg" scheme="http://note.yidianwz.com/tags/node-egg/"/>
    
  </entry>
  
  <entry>
    <title>微信小程序分享朋友圈实现</title>
    <link href="http://note.yidianwz.com/2017/09/09/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%88%86%E4%BA%AB%E6%9C%8B%E5%8F%8B%E5%9C%88%E5%AE%9E%E7%8E%B0/"/>
    <id>http://note.yidianwz.com/2017/09/09/微信小程序分享朋友圈实现/</id>
    <published>2017-09-09T02:43:50.000Z</published>
    <updated>2019-05-09T03:11:34.574Z</updated>
    
    <content type="html"><![CDATA[<h3 id="微信小程序之生成朋友圈分享图，了解一下？"><a href="#微信小程序之生成朋友圈分享图，了解一下？" class="headerlink" title="微信小程序之生成朋友圈分享图，了解一下？"></a>微信小程序之生成朋友圈分享图，了解一下？</h3><p><img src="/2017/09/09/微信小程序分享朋友圈实现/w1.png" title="exp"> <br></p><ul><li>Github项目地址:<a href="https://github.com/MrLeihe/Geek" target="_blank" rel="noopener">https://github.com/MrLeihe/Geek</a></li></ul><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><ul><li><p>在开发小程序的过程中，你是否有将页面生成分享图并引导用户转发至朋友圈的需求？有，那就进来看看，应该是你想要的结果。</p></li><li><p>在分享上，就目前来说，小程序是不能直接分享到朋友圈的，微信官方只开放了分享到好友和群聊的 API。对于分享到朋友圈，现在大多数小程序所采用的方式，就是根据不同的需求生成一张带小程序码的图片引导用户分享至朋友圈。</p></li><li><p>当然分享图也可以在后台生成，但是你懂得，基本没有那个后台大哥愿意为你去用代码写一张图出来，所以，咱们还是自给自足，😆。</p></li><li><p>欢迎大家使用微信扫描【组件库小程序码】（或者微信直接搜索组件库演示）查看运行效果</p></li></ul><p><img src="/2017/09/09/微信小程序分享朋友圈实现/w2.jpg" title="exp"> <br></p><p>生成分享图大致流程如下~<br><img src="/2017/09/09/微信小程序分享朋友圈实现/w3.jpg" title="exp"> <br></p><h3 id="官方文档"><a href="#官方文档" class="headerlink" title="官方文档"></a>官方文档</h3><ul><li><a href="https://developers.weixin.qq.com/miniprogram/dev/api/canvas/reference.html" target="_blank" rel="noopener">绘图相关 API 接口</a></li></ul><h4 id="关于生成二维码"><a href="#关于生成二维码" class="headerlink" title="关于生成二维码"></a>关于生成二维码</h4><ul><li><a href="https://developers.weixin.qq.com/miniprogram/dev/api/qrcode.html" target="_blank" rel="noopener">微信官方获取二维码 API</a></li><li>如果每一次分享的二维码不同，需要要生成 带参数的二维码 （采用接口B）</li><li>生成的二维码需要下载到本地</li><li>别忘了在 小程序微信公众平台后台 - 设置 -  开发设置 - 服务器域名 - downloadFile 合法域名 中添加域名</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;微信小程序之生成朋友圈分享图，了解一下？&quot;&gt;&lt;a href=&quot;#微信小程序之生成朋友圈分享图，了解一下？&quot; class=&quot;headerlink&quot; title=&quot;微信小程序之生成朋友圈分享图，了解一下？&quot;&gt;&lt;/a&gt;微信小程序之生成朋友圈分享图，了解一下？&lt;/h3&gt;&lt;
      
    
    </summary>
    
    
      <category term="小程序" scheme="http://note.yidianwz.com/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>vue项目打包适配和打包路径问题解决</title>
    <link href="http://note.yidianwz.com/2017/08/10/vue%E9%A1%B9%E7%9B%AE%E6%89%93%E5%8C%85%E9%80%82%E9%85%8D%E5%92%8C%E6%89%93%E5%8C%85%E8%B7%AF%E5%BE%84%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/"/>
    <id>http://note.yidianwz.com/2017/08/10/vue项目打包适配和打包路径问题解决/</id>
    <published>2017-08-10T02:31:44.000Z</published>
    <updated>2019-05-09T03:11:34.470Z</updated>
    
    <content type="html"><![CDATA[<h3 id="通过这样的打包方式，放在任何文件夹下面，图片路径都能访问"><a href="#通过这样的打包方式，放在任何文件夹下面，图片路径都能访问" class="headerlink" title="通过这样的打包方式，放在任何文件夹下面，图片路径都能访问"></a>通过这样的打包方式，放在任何文件夹下面，图片路径都能访问</h3><h4 id="注意："><a href="#注意：" class="headerlink" title="注意："></a>注意：</h4><ul><li>一般生成后，文件 /dist/index.html</li><li>所以 引用 static/ 下面的资源，采用 ./static/….相对路径，而不使用绝对路径</li></ul><ul><li>项目目录结构如下（图片习惯放在src-&gt;assets-&gt;img里面）<br><img src="/2017/08/10/vue项目打包适配和打包路径问题解决/vue1.jpg" title="exp"> <br></li></ul><ul><li>第一步，修改config目录里面的index.js文件</li><li>将 assetsPublicPath: ‘/‘ 改为 assetsPublicPath: ‘./‘<br><img src="/2017/08/10/vue项目打包适配和打包路径问题解决/vue2.jpg" title="exp"> <br></li></ul><ul><li>第二步，修改build目录里面的utils.js<br>-加入 publicPath: ‘../../‘,<br><img src="/2017/08/10/vue项目打包适配和打包路径问题解决/vue3.jpg" title="exp"> <br></li></ul><p>接下来就可以愉快的npm run build打包啦~~~</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;通过这样的打包方式，放在任何文件夹下面，图片路径都能访问&quot;&gt;&lt;a href=&quot;#通过这样的打包方式，放在任何文件夹下面，图片路径都能访问&quot; class=&quot;headerlink&quot; title=&quot;通过这样的打包方式，放在任何文件夹下面，图片路径都能访问&quot;&gt;&lt;/a&gt;通过
      
    
    </summary>
    
    
      <category term="vue vue-cli" scheme="http://note.yidianwz.com/tags/vue-vue-cli/"/>
    
  </entry>
  
  <entry>
    <title>搭建科学上网和进程管理</title>
    <link href="http://note.yidianwz.com/2017/07/09/%E6%90%AD%E5%BB%BA%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91%E5%92%8C%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86/"/>
    <id>http://note.yidianwz.com/2017/07/09/搭建科学上网和进程管理/</id>
    <published>2017-07-09T02:17:51.000Z</published>
    <updated>2019-05-09T03:11:34.592Z</updated>
    
    <content type="html"><![CDATA[<p>如果你还在为无法访问国外网站而苦恼，如果你还在为寻找免费、高速的VPN而苦恼，如果你还在为怎么自己折腾Shadowsocks而苦恼，那么恭喜你，当你看到这篇文章，以上问题，将不再是问题，下面将教你，如何从零开始搭建属于自己的VPN，如何像访问国内网站那样迅速打开国外网站，这篇文章，就是大家的福音。</p><h4 id="Shadowsocks特点"><a href="#Shadowsocks特点" class="headerlink" title="Shadowsocks特点"></a>Shadowsocks特点</h4><p>省电，在电量查看里几乎看不到它的身影；<br>支持开机自启动，且断网无影响，无需手动重连，方便网络不稳定或者3G&amp;Wi-Fi频繁切换的小伙伴；<br>可使用自己的服务器，安全和速度的保证；<br>支持区分国内外流量，传统VPN在翻出墙外后访问国内站点会变慢；<br>可对应用设置单独代理，5.0之后的系统无需root。<br>我自己的感受：随机启动24小时后台运行，占内存10MB以内，基本不怎么耗电，跟人直接置身墙外使用手机的感受差不多。</p><h4 id="Shadowsocks服务端搭建"><a href="#Shadowsocks服务端搭建" class="headerlink" title="Shadowsocks服务端搭建"></a>Shadowsocks服务端搭建</h4><p>服务端搭建的前提是你已经成功使用SecureCRT或putty或者xshell连接服务器，接下来的工作就是按照下面的步骤依次执行：</p><h4 id="1-环境安装与更新"><a href="#1-环境安装与更新" class="headerlink" title="1.环境安装与更新"></a>1.环境安装与更新</h4><ul><li>这一步，你需要做的是依次执行下面的每条命令：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yum install epel-release</span><br><span class="line">yum update</span><br><span class="line">yum install python-setuptools m2crypto supervisor</span><br><span class="line">easy_install pip</span><br><span class="line">pip install shadowsocks</span><br></pre></td></tr></table></figure></li></ul><h4 id="2-文件配置"><a href="#2-文件配置" class="headerlink" title="2.文件配置"></a>2.文件配置</h4><ul><li><p>接下来需要编辑一下/etc/shadowsocks.json文件，命令如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/shadowsocks.json</span><br></pre></td></tr></table></figure></li><li><p>执行上述命令后，此时的你已经进入文件编辑模式，这是你创建的一个新的空白文件，你需要做的事情就是将下面的内容粘贴后复制到shadowsocks.json文件里：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;server&quot;:&quot;0.0.0.0&quot;,</span><br><span class="line">    &quot;server_port&quot;:8388,</span><br><span class="line">    &quot;local_port&quot;:1080,</span><br><span class="line">    &quot;password&quot;:&quot;yourpassword&quot;,</span><br><span class="line">    &quot;timeout&quot;:600,</span><br><span class="line">    &quot;method&quot;:&quot;aes-256-cfb&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>接下来需要编辑一下/etc/supervisord.conf文件，命令如下：</p></li><li><p>SUPERVISORD配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo_supervisord_conf &gt; /etc/supervisord.conf</span><br></pre></td></tr></table></figure></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/supervisord.conf</span><br></pre></td></tr></table></figure><ul><li><p>此时，你已进入supervisord.conf文件的编辑模式，这不是一个空白文件，里面有很多英文，请把下面的内容粘贴到文件尾部的空行处，然后保存：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[program:shadowsocks]</span><br><span class="line">command=ssserver -c /etc/shadowsocks.json</span><br><span class="line">autostart=true</span><br><span class="line">autorestart=true</span><br><span class="line">user=root</span><br><span class="line">log_stderr=true</span><br><span class="line">logfile=/var/log/shadowsocks.log</span><br></pre></td></tr></table></figure></li><li><p>接下来需要编辑一下/etc/rc.local文件，请执行以下命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/rc.local</span><br></pre></td></tr></table></figure></li><li><p>此时，你进入了rc.local文件的编辑模式，这也不是一个空白文件，请把以下内容粘贴到文件中部的空白处，然后保存</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service supervisord start （没执行）   //或者  /usr/bin/supervisord start （执行了）</span><br></pre></td></tr></table></figure></li><li><p>最后执行reboot命令或者vps的重启按钮，重启服务器。</p></li></ul><p>SUPERVISORD管理<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/supervisord -c /etc/supervisord.conf</span><br></pre></td></tr></table></figure></p><h4 id="Supervisord安装完成后有两个可用的命令行supervisor和supervisorctl，命令使用解释如下："><a href="#Supervisord安装完成后有两个可用的命令行supervisor和supervisorctl，命令使用解释如下：" class="headerlink" title="Supervisord安装完成后有两个可用的命令行supervisor和supervisorctl，命令使用解释如下："></a>Supervisord安装完成后有两个可用的命令行supervisor和supervisorctl，命令使用解释如下：</h4><ul><li>supervisord，初始启动Supervisord，启动、管理配置中设置的进程。</li><li>supervisorctl stop programxxx，停止某一个进程(programxxx)，programxxx为[program:blogdemon]里配置的值，这个示例就是blogdemon。</li><li>supervisorctl start programxxx，启动某个进程</li><li>supervisorctl restart programxxx，重启某个进程</li><li>supervisorctl stop all，停止全部进程，注：start、restart、stop都不会载入最新的配置文件。</li><li>supervisorctl reload，载入最新的配置文件，并按新的配置启动、管理所有进程。</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;如果你还在为无法访问国外网站而苦恼，如果你还在为寻找免费、高速的VPN而苦恼，如果你还在为怎么自己折腾Shadowsocks而苦恼，那么恭喜你，当你看到这篇文章，以上问题，将不再是问题，下面将教你，如何从零开始搭建属于自己的VPN，如何像访问国内网站那样迅速打开国外网站，这
      
    
    </summary>
    
    
      <category term="科学上网" scheme="http://note.yidianwz.com/tags/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/"/>
    
  </entry>
  
</feed>
